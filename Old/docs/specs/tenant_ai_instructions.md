# –¢–ó: Tenant AI Instructions (–û–±—É—á–∞–µ–º—ã–µ —Ä–µ–∞–∫—Ü–∏–∏ –±–æ—Ç–∞)

> –í–µ—Ä—Å–∏—è: 1.0 MVP
> –î–∞—Ç–∞: 2024-12-06
> –°—Ç–∞—Ç—É—Å: –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## –¶–µ–ª—å

–î–∞—Ç—å —Ç–µ–Ω–∞–Ω—Ç—É –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –æ—Ç–≤–µ—Ç—ã AI-–±–æ—Ç–∞ –ø–æ–¥ —Å–≤–æ–π –±–∏–∑–Ω–µ—Å —á–µ—Ä–µ–∑ –ø—Ä–æ—Å—Ç–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.

**–§–æ—Ä–º—É–ª–∞:**
```
–ö–û–ì–î–ê –∫–ª–∏–µ–Ω—Ç –ø–∏—à–µ—Ç X (+ –∫–æ–Ω—Ç–µ–∫—Å—Ç)  ‚Üí  –¢–û–ì–î–ê –±–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç —Å —É—á—ë—Ç–æ–º Y
```

---

## –¶–µ–Ω–Ω–æ—Å—Ç—å –¥–ª—è —Ç–µ–Ω–∞–Ω—Ç–∞

- –ö–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –±–æ—Ç–æ–º –±–µ–∑ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è
- –ü–æ–¥—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–¥ —Å–≤–æ–π —Å—Ç–∏–ª—å –æ–±—â–µ–Ω–∏—è
- –†–∞–∑–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏–π
- –ë—ã—Å—Ç—Ä–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ "–ø–ª–æ—Ö–∏—Ö" –æ—Ç–≤–µ—Ç–æ–≤ –±–æ—Ç–∞

**–ü—Ä–∏–º–µ—Ä:**
```
–¢–µ–Ω–∞–Ω—Ç "–†–µ–º–æ–Ω—Ç iPhone –ú–æ—Å–∫–≤–∞":
‚Ä¢ "–¥–æ—Ä–æ–≥–æ" ‚Üí –ø—Ä–µ–¥–ª–æ–∂–∏ —Ä–∞—Å—Å—Ä–æ—á–∫—É –¢–∏–Ω—å–∫–æ—Ñ—Ñ
‚Ä¢ "–≥–∞—Ä–∞–Ω—Ç–∏—è" ‚Üí 1 –≥–æ–¥ –Ω–∞ —Ä–∞–±–æ—Ç—É, 6 –º–µ—Å –Ω–∞ –∑–∞–ø—á–∞—Å—Ç–∏
‚Ä¢ "–æ—Ä–∏–≥–∏–Ω–∞–ª –∏–ª–∏ –∫–æ–ø–∏—è" ‚Üí —Ç–æ–ª—å–∫–æ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –¥–∏—Å–ø–ª–µ–∏

–¢–µ–Ω–∞–Ω—Ç "–°–µ—Ä–≤–∏—Å Samsung –ü–∏—Ç–µ—Ä":
‚Ä¢ "–¥–æ—Ä–æ–≥–æ" ‚Üí —Å–∫–∏–¥–∫–∞ 15% –¥–ª—è –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ VK
‚Ä¢ "–≥–∞—Ä–∞–Ω—Ç–∏—è" ‚Üí 2 –≥–æ–¥–∞ –Ω–∞ –≤—Å—ë
```

---

## MVP Scope

### –í–∫–ª—é—á–µ–Ω–æ
- –¢—Ä–∏–≥–≥–µ—Ä –ø–æ —Å–æ–æ–±—â–µ–Ω–∏—é –∫–ª–∏–µ–Ω—Ç–∞ (semantic match)
- –ö–æ–Ω—Ç–µ–∫—Å—Ç –∏–∑ appeal (–±—Ä–µ–Ω–¥, –º–æ–¥–µ–ª—å, —Ç–∏–ø –ø—Ä–æ–±–ª–µ–º—ã, –Ω–æ–≤—ã–π/–ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∫–ª–∏–µ–Ω—Ç)
- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è AI –∫–∞–∫ –æ—Ç–≤–µ—á–∞—Ç—å
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–∑ –¥–∏–∞–ª–æ–≥–∞ (–∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ)
- –ü—Ä–æ—Å—Ç–æ–π UI –º–∞—Å—Ç–µ—Ä–∞

### –ù–ï –≤–∫–ª—é—á–µ–Ω–æ (v2.0+)
- –°–æ–±—ã—Ç–∏—è —Å–∏—Å—Ç–µ–º—ã (–æ–ø–µ—Ä–∞—Ç–æ—Ä –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª, –±–æ—Ç –Ω–µ –ø–æ–Ω—è–ª)
- –î–µ–π—Å—Ç–≤–∏—è (—ç—Å–∫–∞–ª–∞—Ü–∏—è, —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏, –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø—Ä–∞–π—Å–∞)
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- –°–ª–æ–∂–Ω–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

```
1. –ö–ª–∏–µ–Ω—Ç –ø–∏—à–µ—Ç: "25 —Ç—ã—Å—è—á –∑–∞ —ç–∫—Ä–∞–Ω? –≠—Ç–æ –¥–æ—Ä–æ–≥–æ!"

2. –°–∏—Å—Ç–µ–º–∞:
   a) –°–æ–∑–¥–∞—ë—Ç embedding —Å–æ–æ–±—â–µ–Ω–∏—è
   b) –ò—â–µ—Ç –ø–æ—Ö–æ–∂–∏–µ trigger_text (cosine similarity > 0.7)
   c) –§–∏–ª—å—Ç—Ä—É–µ—Ç –ø–æ conditions (brand, is_new_client, etc.)
   d) –ë–µ—Ä—ë—Ç top-3 –ø–æ priority

3. –ù–∞–π–¥–µ–Ω–æ:
   - "–¥–æ—Ä–æ–≥–æ" ‚Üí "–ø—Ä–µ–¥–ª–æ–∂–∏ —Ä–∞—Å—Å—Ä–æ—á–∫—É" (priority 7)
   - "—Ü–µ–Ω–∞ –≤—ã—Å–æ–∫–∞—è" ‚Üí "–æ–±—ä—è—Å–Ω–∏ —Ü–µ–Ω–Ω–æ—Å—Ç—å" (priority 5)

4. Inject –≤ AI prompt:
   """
   –°–ü–ï–¶–ò–ê–õ–¨–ù–´–ï –ò–ù–°–¢–†–£–ö–¶–ò–ò –¢–ï–ù–ê–ù–¢–ê:
   1. –ü—Ä–µ–¥–ª–æ–∂–∏ —Ä–∞—Å—Å—Ä–æ—á–∫—É –Ω–∞ 3 –º–µ—Å—è—Ü–∞ –±–µ–∑ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤
   2. –û–±—ä—è—Å–Ω–∏ —Ü–µ–Ω–Ω–æ—Å—Ç—å (–æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –∑–∞–ø—á–∞—Å—Ç–∏, –≥–∞—Ä–∞–Ω—Ç–∏—è)
   """

5. AI –æ—Ç–≤–µ—á–∞–µ—Ç —Å —É—á—ë—Ç–æ–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π
```

### –¢–æ—á–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

```
BAT_AI_Universal_Worker (—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π)
         ‚îÇ
         ‚îú‚îÄ‚îÄ [NEW] –ü–µ—Ä–µ–¥ AI: SELECT FROM tenant_ai_instructions
         ‚îÇ
         ‚îî‚îÄ‚îÄ [NEW] –î–æ–±–∞–≤–∏—Ç—å –≤ prompt: "–ò–ù–°–¢–†–£–ö–¶–ò–ò: ..."
```

---

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞: tenant_ai_instructions

```sql
CREATE TABLE tenant_ai_instructions (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    tenant_id UUID NOT NULL,

    -- –¢—Ä–∏–≥–≥–µ—Ä
    trigger_text TEXT NOT NULL,           -- "–¥–æ—Ä–æ–≥–æ, —Å–ª–∏—à–∫–æ–º –¥–æ—Ä–æ–≥–æ, –∞ —Å–∫–∏–¥–∫–∞ –µ—Å—Ç—å?"
    trigger_embedding vector(1536),       -- OpenAI embedding –¥–ª—è semantic search

    -- –£—Å–ª–æ–≤–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    conditions JSONB DEFAULT '{}',
    -- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ conditions:
    -- {
    --   "brand_id": "uuid",              -- —Ç–æ–ª—å–∫–æ –¥–ª—è —ç—Ç–æ–≥–æ –±—Ä–µ–Ω–¥–∞
    --   "repair_category_id": "uuid",    -- —Ç–æ–ª—å–∫–æ –¥–ª—è —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    --   "is_new_client": true,           -- —Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–æ–≤—ã—Ö
    --   "channel": "telegram"            -- —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–∞–Ω–∞–ª–∞
    -- }

    -- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
    instruction TEXT NOT NULL,            -- "–ø—Ä–µ–¥–ª–æ–∂–∏ —Ä–∞—Å—Å—Ä–æ—á–∫—É –Ω–∞ 3 –º–µ—Å—è—Ü–∞..."

    -- –ú–µ—Ç–∞
    priority INT DEFAULT 5 CHECK (priority BETWEEN 1 AND 10),
    is_active BOOLEAN DEFAULT TRUE,

    -- –ò—Å—Ç–æ—á–Ω–∏–∫ (–¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞)
    source_message_id UUID,               -- –∏–∑ –∫–∞–∫–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è —Å–æ–∑–¥–∞–Ω–æ
    source_appeal_id UUID,                -- –∏–∑ –∫–∞–∫–æ–≥–æ appeal
    created_by VARCHAR(20),               -- voice / text / ui

    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- –¢—Ä–µ–±—É–µ—Ç—Å—è: CREATE EXTENSION IF NOT EXISTS vector;

-- –ò–Ω–¥–µ–∫—Å –¥–ª—è semantic search
CREATE INDEX idx_instructions_embedding
ON tenant_ai_instructions
USING ivfflat (trigger_embedding vector_cosine_ops)
WHERE is_active = true;

-- –ò–Ω–¥–µ–∫—Å –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ tenant
CREATE INDEX idx_instructions_tenant
ON tenant_ai_instructions(tenant_id)
WHERE is_active = true;
```

### –§—É–Ω–∫—Ü–∏—è –ø–æ–∏—Å–∫–∞

```sql
CREATE OR REPLACE FUNCTION match_tenant_instructions(
    p_tenant_id UUID,
    p_embedding vector(1536),
    p_conditions JSONB DEFAULT '{}',
    p_limit INT DEFAULT 5,
    p_threshold FLOAT DEFAULT 0.7
)
RETURNS TABLE (
    id UUID,
    trigger_text TEXT,
    instruction TEXT,
    priority INT,
    similarity FLOAT
) AS $$
BEGIN
    RETURN QUERY
    SELECT
        i.id,
        i.trigger_text,
        i.instruction,
        i.priority,
        1 - (i.trigger_embedding <-> p_embedding) as similarity
    FROM tenant_ai_instructions i
    WHERE i.tenant_id = p_tenant_id
      AND i.is_active = true
      AND 1 - (i.trigger_embedding <-> p_embedding) >= p_threshold
      -- –§–∏–ª—å—Ç—Ä –ø–æ —É—Å–ª–æ–≤–∏—è–º
      AND (
          i.conditions = '{}'::jsonb
          OR (
              (i.conditions->>'brand_id' IS NULL OR i.conditions->>'brand_id' = p_conditions->>'brand_id')
              AND (i.conditions->>'repair_category_id' IS NULL OR i.conditions->>'repair_category_id' = p_conditions->>'repair_category_id')
              AND (i.conditions->>'is_new_client' IS NULL OR (i.conditions->>'is_new_client')::boolean = (p_conditions->>'is_new_client')::boolean)
              AND (i.conditions->>'channel' IS NULL OR i.conditions->>'channel' = p_conditions->>'channel')
          )
      )
    ORDER BY i.priority DESC, similarity DESC
    LIMIT p_limit;
END;
$$ LANGUAGE plpgsql;
```

---

## UI: –ú–∞—Å—Ç–µ—Ä –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

### –¢–æ—á–∫–∏ –≤—Ö–æ–¥–∞ (Android)

| –û—Ç–∫—É–¥–∞ | –î–µ–π—Å—Ç–≤–∏–µ | –ö–æ–Ω—Ç–µ–∫—Å—Ç |
|--------|----------|----------|
| –°–æ–æ–±—â–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ | Long press ‚Üí "–ù–∞—É—á–∏—Ç—å –±–æ—Ç–∞" | message + appeal + device |
| –û—Ç–≤–µ—Ç –±–æ—Ç–∞ | Long press ‚Üí "–£–ª—É—á—à–∏—Ç—å –æ—Ç–≤–µ—Ç" | + —Ç–µ–∫—É—â–∏–π –æ—Ç–≤–µ—Ç –±–æ—Ç–∞ |
| –ù–∞—Å—Ç—Ä–æ–π–∫–∏ | "–î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é" | –ø—É—Å—Ç–æ–π –∫–æ–Ω—Ç–µ–∫—Å—Ç |

### –≠–∫—Ä–∞–Ω—ã –º–∞—Å—Ç–µ—Ä–∞

**–®–∞–≥ 1: –¢—Ä–∏–≥–≥–µ—Ä**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ö–æ–≥–¥–∞ –∫–ª–∏–µ–Ω—Ç –ø–∏—à–µ—Ç...               ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                     ‚îÇ
‚îÇ  –°–æ–æ–±—â–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞:                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê‚îÇ
‚îÇ  ‚îÇ "25 —Ç—ã—Å—è—á –∑–∞ —ç–∫—Ä–∞–Ω? –î–æ—Ä–æ–≥–æ!"   ‚îÇ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò‚îÇ
‚îÇ                                     ‚îÇ
‚îÇ  –ù–∞ —á—Ç–æ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å:                ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê‚îÇ
‚îÇ  ‚îÇ üé§ –¥–æ—Ä–æ–≥–æ / —Å–ª–∏—à–∫–æ–º –¥–æ—Ä–æ–≥–æ /   ‚îÇ‚îÇ
‚îÇ  ‚îÇ    –∞ —Å–∫–∏–¥–∫–∞ –µ—Å—Ç—å?               ‚îÇ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò‚îÇ
‚îÇ                                     ‚îÇ
‚îÇ  [–ù–∞–∑–∞–¥]                  [–î–∞–ª–µ–µ ‚Üí] ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–®–∞–≥ 2: –£—Å–ª–æ–≤–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ü—Ä–∏ –∫–∞–∫–∏—Ö —É—Å–ª–æ–≤–∏—è—Ö?                 ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                     ‚îÇ
‚îÇ  –ö–æ–Ω—Ç–µ–∫—Å—Ç –∏–∑ –¥–∏–∞–ª–æ–≥–∞:               ‚îÇ
‚îÇ  ‚Ä¢ –ë—Ä–µ–Ω–¥: Apple                     ‚îÇ
‚îÇ  ‚Ä¢ –ü—Ä–æ–±–ª–µ–º–∞: –ó–∞–º–µ–Ω–∞ —ç–∫—Ä–∞–Ω–∞          ‚îÇ
‚îÇ  ‚Ä¢ –ö–ª–∏–µ–Ω—Ç: –ù–æ–≤—ã–π                    ‚îÇ
‚îÇ                                     ‚îÇ
‚îÇ  –ü—Ä–∏–º–µ–Ω—è—Ç—å –ø—Ä–∞–≤–∏–ª–æ:                 ‚îÇ
‚îÇ  ‚óã –í—Å–µ–≥–¥–∞ (–ª—é–±–æ–π –∫–æ–Ω—Ç–µ–∫—Å—Ç)          ‚îÇ
‚îÇ  ‚óè –ö–∞–∫ –≤ —ç—Ç–æ–º –¥–∏–∞–ª–æ–≥–µ               ‚îÇ
‚îÇ  ‚óã –ù–∞—Å—Ç—Ä–æ—é —Å–∞–º:                     ‚îÇ
‚îÇ    ‚òë –ë—Ä–µ–Ω–¥: [Apple ‚ñº]               ‚îÇ
‚îÇ    ‚òê –ö–∞—Ç–µ–≥–æ—Ä–∏—è: [–ª—é–±–∞—è]             ‚îÇ
‚îÇ    ‚òë –ö–ª–∏–µ–Ω—Ç: [–ù–æ–≤—ã–π ‚ñº]              ‚îÇ
‚îÇ                                     ‚îÇ
‚îÇ  [‚Üê –ù–∞–∑–∞–¥]                [–î–∞–ª–µ–µ ‚Üí] ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–®–∞–≥ 3: –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ë–æ—Ç –¥–æ–ª–∂–µ–Ω...                       ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                     ‚îÇ
‚îÇ  –¢–µ–∫—É—â–∏–π –æ—Ç–≤–µ—Ç –±–æ—Ç–∞:                ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê‚îÇ
‚îÇ  ‚îÇ "–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, —ç—Ç–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è  ‚îÇ‚îÇ
‚îÇ  ‚îÇ  —Ü–µ–Ω–∞ –∑–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —ç–∫—Ä–∞–Ω."  ‚îÇ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò‚îÇ
‚îÇ                                     ‚îÇ
‚îÇ  –ö–∞–∫ –Ω—É–∂–Ω–æ –æ—Ç–≤–µ—á–∞—Ç—å:                ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê‚îÇ
‚îÇ  ‚îÇ üé§ –ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å —Ä–∞—Å—Å—Ä–æ—á–∫—É –Ω–∞ 3   ‚îÇ‚îÇ
‚îÇ  ‚îÇ    –º–µ—Å—è—Ü–∞ –±–µ–∑ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤.        ‚îÇ‚îÇ
‚îÇ  ‚îÇ    –£–ø–æ–º—è–Ω—É—Ç—å —Å–∫–∏–¥–∫—É 10% –ø—Ä–∏    ‚îÇ‚îÇ
‚îÇ  ‚îÇ    –ø–æ–ª–Ω–æ–π –æ–ø–ª–∞—Ç–µ.               ‚îÇ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò‚îÇ
‚îÇ                                     ‚îÇ
‚îÇ  –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: [‚óè‚óè‚óè‚óè‚óè‚óè‚óè‚óã‚óã‚óã] 7          ‚îÇ
‚îÇ                                     ‚îÇ
‚îÇ  [‚Üê –ù–∞–∑–∞–¥]            [‚úì –°–æ—Ö—Ä–∞–Ω–∏—Ç—å] ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Web/PC UI (–ø–æ–ª–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ AI –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏                           [+ –î–æ–±–∞–≤–∏—Ç—å]        ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ üîç –ü–æ–∏—Å–∫...                     –§–∏–ª—å—Ç—Ä: [–í—Å–µ ‚ñº]            ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                             ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ ‚îÇ ‚òë –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: 7  ‚îÇ –£—Å–ª–æ–≤–∏—è: Apple + –ù–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç        ‚îÇ ‚îÇ
‚îÇ ‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚îÇ ‚îÇ
‚îÇ ‚îÇ –¢—Ä–∏–≥–≥–µ—Ä: –¥–æ—Ä–æ–≥–æ / —Å–ª–∏—à–∫–æ–º –¥–æ—Ä–æ–≥–æ / —Å–∫–∏–¥–∫–∞ –µ—Å—Ç—å?        ‚îÇ ‚îÇ
‚îÇ ‚îÇ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è: –ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å —Ä–∞—Å—Å—Ä–æ—á–∫—É –Ω–∞ 3 –º–µ—Å—è—Ü–∞...        ‚îÇ ‚îÇ
‚îÇ ‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚îÇ ‚îÇ
‚îÇ ‚îÇ                              [‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å] [üóëÔ∏è –£–¥–∞–ª–∏—Ç—å] ‚îÇ ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ                                                             ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ ‚îÇ ‚òë –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: 5  ‚îÇ –£—Å–ª–æ–≤–∏—è: ‚Äî                           ‚îÇ ‚îÇ
‚îÇ ‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚îÇ ‚îÇ
‚îÇ ‚îÇ –¢—Ä–∏–≥–≥–µ—Ä: –≥–∞—Ä–∞–Ω—Ç–∏—è / —Å–∫–æ–ª—å–∫–æ –≥–∞—Ä–∞–Ω—Ç–∏—è                   ‚îÇ ‚îÇ
‚îÇ ‚îÇ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è: 1 –≥–æ–¥ –Ω–∞ —Ä–∞–±–æ—Ç—É, 6 –º–µ—Å—è—Ü–µ–≤ –Ω–∞ –∑–∞–ø—á–∞—Å—Ç–∏     ‚îÇ ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ                                                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## API Endpoints

```
# –°–ø–∏—Å–æ–∫ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π —Ç–µ–Ω–∞–Ω—Ç–∞
GET /api/instructions
Response: [{ id, trigger_text, instruction, conditions, priority, is_active, created_at }]

# –°–æ–∑–¥–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é
POST /api/instructions
Body: {
  trigger_text: "–¥–æ—Ä–æ–≥–æ, —Å–ª–∏—à–∫–æ–º –¥–æ—Ä–æ–≥–æ",
  instruction: "–ø—Ä–µ–¥–ª–æ–∂–∏ —Ä–∞—Å—Å—Ä–æ—á–∫—É...",
  conditions: { brand_id: "...", is_new_client: true },
  priority: 7,
  source_message_id: "...",  // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
  source_appeal_id: "..."    // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
}

# –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é (Web/PC only)
PUT /api/instructions/{id}
Body: { trigger_text, instruction, conditions, priority }

# –£–¥–∞–ª–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é (Web/PC only)
DELETE /api/instructions/{id}

# –í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å (Web/PC only)
PATCH /api/instructions/{id}/toggle
```

---

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ AI Worker

### –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ BAT_AI_Universal_Worker

**–ü–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º AI Agent:**

```javascript
// 1. –°–æ–∑–¥–∞—Ç—å embedding —Å–æ–æ–±—â–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞
const messageEmbedding = await openai.embeddings.create({
  model: "text-embedding-3-small",
  input: task.input_message
});

// 2. –°–æ–±—Ä–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç
const conditions = {
  brand_id: task.brand_id,
  repair_category_id: task.repair_category_id,
  is_new_client: task.is_new_client,
  channel: task.channel
};

// 3. –ù–∞–π—Ç–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
const instructions = await supabase.rpc('match_tenant_instructions', {
  p_tenant_id: task.tenant_id,
  p_embedding: messageEmbedding,
  p_conditions: conditions,
  p_limit: 3,
  p_threshold: 0.7
});

// 4. –î–æ–±–∞–≤–∏—Ç—å –≤ prompt
if (instructions.length > 0) {
  const instructionBlock = instructions
    .map((i, idx) => `${idx + 1}. ${i.instruction}`)
    .join('\n');

  task.system_prompt += `

## –°–ü–ï–¶–ò–ê–õ–¨–ù–´–ï –ò–ù–°–¢–†–£–ö–¶–ò–ò –¢–ï–ù–ê–ù–¢–ê:
${instructionBlock}

–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —É—á–∏—Ç—ã–≤–∞–π —ç—Ç–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø—Ä–∏ –æ—Ç–≤–µ—Ç–µ.`;
}
```

---

## –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –§–∞–∑–∞ 1: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- [ ] –í–∫–ª—é—á–∏—Ç—å pgvector extension
- [ ] –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É `tenant_ai_instructions`
- [ ] –°–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `match_tenant_instructions`
- [ ] –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

### –§–∞–∑–∞ 2: API
- [ ] Endpoints –≤ api-android
- [ ] –°–æ–∑–¥–∞–Ω–∏–µ embedding –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è

### –§–∞–∑–∞ 3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ AI Worker
- [ ] –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è BAT_AI_Universal_Worker
- [ ] –ü–æ–∏—Å–∫ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π
- [ ] Inject –≤ prompt
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –§–∞–∑–∞ 4: Android UI
- [ ] –ú–∞—Å—Ç–µ—Ä –¥–æ–±–∞–≤–ª–µ–Ω–∏—è (3 —à–∞–≥–∞)
- [ ] Long press –º–µ–Ω—é –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö
- [ ] –ì–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥
- [ ] –°–ø–∏—Å–æ–∫ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö

### –§–∞–∑–∞ 5: Web UI
- [ ] –°–ø–∏—Å–æ–∫ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π
- [ ] –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –£–¥–∞–ª–µ–Ω–∏–µ
- [ ] –§–∏–ª—å—Ç—Ä—ã

---

## –§–∞–π–ª—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è/–∏–∑–º–µ–Ω–µ–Ω–∏—è

```
supabase/migrations/
  20251207_tenant_ai_instructions.sql

MCP/api-android/
  app.py                              # –¥–æ–±–∞–≤–∏—Ç—å endpoints
  models/instruction.py               # –º–æ–¥–µ–ª—å

n8n_workflows/
  TaskWork/BAT_AI_Universal_Worker.json  # –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è

app/src/main/java/com/eldoleado/app/
  ui/instructions/
    AddInstructionWizard.kt           # –º–∞—Å—Ç–µ—Ä
    InstructionStep1Fragment.kt       # —Ç—Ä–∏–≥–≥–µ—Ä
    InstructionStep2Fragment.kt       # —É—Å–ª–æ–≤–∏—è
    InstructionStep3Fragment.kt       # –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
  viewmodel/
    InstructionsViewModel.kt
  data/
    model/Instruction.kt
    repository/InstructionsRepository.kt
    api/InstructionsApi.kt
```

---

## Roadmap

| –í–µ—Ä—Å–∏—è | –ß—Ç–æ –¥–æ–±–∞–≤–ª—è–µ–º |
|--------|---------------|
| **MVP** | –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è AI –æ—Ç–≤–µ—Ç–æ–≤ |
| **v1.1** | Neo4j —Å–≤—è–∑–∏ —Å —Å—É—â–Ω–æ—Å—Ç—è–º–∏ (Brand, Model) |
| **v2.0** | –°–æ–±—ã—Ç–∏—è —Å–∏—Å—Ç–µ–º—ã (–±–æ—Ç –Ω–µ –ø–æ–Ω—è–ª, —Ç–∞–π–º–∞—É—Ç) |
| **v3.0** | –î–µ–π—Å—Ç–≤–∏—è (—ç—Å–∫–∞–ª–∞—Ü–∏—è, –∑–∞–¥–∞—á–∏, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è) |
| **v4.0** | –£–º–Ω—ã–π —Ä–æ—É—Ç–µ—Ä, –º–æ–¥—É–ª—å–Ω—ã–µ –±–ª–æ–∫–∏ |
