# üöÄ DEPLOY NOW - AI Multi-Entity Extractor (OpenAI)

## ‚úÖ –í–°–Å –ì–û–¢–û–í–û –ö –î–ï–ü–õ–û–Æ

**–î–∞—Ç–∞:** 2025-11-23
**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤ –∫ –∏–º–ø–æ—Ä—Ç—É –≤ n8n

---

## üìÅ –§–∞–π–ª—ã –≥–æ—Ç–æ–≤—ã

1. ‚úÖ [workflows/BAT AI Multi-Entity Extractor (OpenAI).json](workflows/BAT%20AI%20Multi-Entity%20Extractor%20(OpenAI).json)
2. ‚úÖ [DEPLOYMENT_CHECKLIST_OPENAI.md](DEPLOYMENT_CHECKLIST_OPENAI.md) - –ø–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

---

## ‚ö° –ë—ã—Å—Ç—Ä—ã–π –¥–µ–ø–ª–æ–π (10 –º–∏–Ω—É—Ç)

### 1Ô∏è‚É£ –ò–º–ø–æ—Ä—Ç workflow –≤ n8n

```bash
# 1. –û—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª
workflows/BAT AI Multi-Entity Extractor (OpenAI).json

# 2. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –í–°–Å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ (Ctrl+A, Ctrl+C)

# 3. –ü–µ—Ä–µ–π—Ç–∏ –≤ n8n
https://n8n.n8nsrv.ru

# 4. Workflows ‚Üí + ‚Üí Import from Clipboard ‚Üí –í—Å—Ç–∞–≤–∏—Ç—å ‚Üí Import
```

### 2Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å credentials (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–∫–ª—é—á–∞—Ç—Å—è)

- PostgreSQL: `Postgres account` ‚úÖ
- OpenAI: `OpenAI account` ‚úÖ

### 3Ô∏è‚É£ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å (Ctrl+S)

### 4Ô∏è‚É£ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

**Test workflow** ‚Üí –≤—Å—Ç–∞–≤–∏—Ç—å:

```json
{
  "tenant_id": "a0000000-0000-0000-0000-000000000001",
  "appeal_id": "00000000-0000-0000-0000-000000000001",
  "current_message": "–£ –º–µ–Ω—è –¥–≤–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞: iPhone 14 - –±–∞—Ç–∞—Ä–µ—è –∏ —Ä–∞–∑–±–∏—Ç —ç–∫—Ä–∞–Ω, –∏ Samsung S23 - –Ω–µ –∑–∞—Ä—è–∂–∞–µ—Ç—Å—è",
  "message_history": []
}
```

‚Üí **Execute**

### 5Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–í –ø–æ—Å–ª–µ–¥–Ω–µ–º node **Map To DB IDs** –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:

```json
{
  "is_multi_device": true,
  "device_count": 2,
  "devices": [
    {
      "brand": "Apple",
      "model": "iPhone 14",
      "repairs": [
        {"category_name": "–ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä"},
        {"category_name": "–î–∏—Å–ø–ª–µ–π"}
      ]
    },
    {
      "brand": "Samsung",
      "model": "Galaxy S23",
      "repairs": [
        {"category_name": "–ü–æ—Ä—Ç—ã"}
      ]
    }
  ]
}
```

‚úÖ **–ï—Å–ª–∏ –≤–∏–¥–∏—à—å —ç—Ç–æ ‚Äî –í–°–Å –†–ê–ë–û–¢–ê–ï–¢!**

### 6Ô∏è‚É£ –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å Workflow ID

–ò–∑ URL:
```
https://n8n.n8nsrv.ru/workflow/XXXXXXXXXXXXX
                                ^^^^^^^^^^^^
```

---

## üéØ –ß—Ç–æ –¥–∞–ª—å—à–µ?

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞:

1. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ Appeal Router** (15 –º–∏–Ω)
   - –û—Ç–∫—Ä—ã—Ç—å **BAT AI Appeal Router**
   - –î–æ–±–∞–≤–∏—Ç—å node **Execute Workflow** —Å –Ω–æ–≤—ã–º Workflow ID
   - –ü–æ–¥–∫–ª—é—á–∏—Ç—å –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
   - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç —á–µ—Ä–µ–∑ Multi-Appeal API

2. **E2E —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** (5 –º–∏–Ω)
   - –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä–µ–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ë–î (`appeal_devices`, `appeal_repairs`)

---

## üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å

- **OpenAI GPT-4o-mini:** $0.0005 –∑–∞ –∑–∞–ø—Ä–æ—Å
- **1000 –∑–∞—è–≤–æ–∫/–º–µ—Å—è—Ü:** ~$0.50/–º–µ—Å—è—Ü
- **–í 24 —Ä–∞–∑–∞ –¥–µ—à–µ–≤–ª–µ Anthropic!**

---

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|:--------|:---------|
| –¢–æ—á–Ω–æ—Å—Ç—å –∏–∑–≤–ª–µ—á–µ–Ω–∏—è | >95% |
| –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è | 1-2 —Å–µ–∫ |
| –°—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–∞ | $0.0005 |
| –ü—Ä–æ—Ü–µ–Ω—Ç –æ—à–∏–±–æ–∫ | <1% |

---

## üêõ –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

### OpenAI API error: 401
‚Üí –ü—Ä–æ–≤–µ—Ä–∏—Ç—å credential `OpenAI account` –≤ n8n
‚Üí –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–ª–∞–Ω—Å: https://platform.openai.com/usage

### Failed to parse JSON
‚Üí –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—ã—Ä–æ–π –æ—Ç–≤–µ—Ç –≤ node **Call OpenAI**
‚Üí Node **Parse AI Response** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑–≤–ª–µ—á—ë—Ç JSON –∏–∑ markdown

### –ù–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ
‚Üí –£–≤–µ–ª–∏—á–∏—Ç—å `temperature` —Å 0.3 –¥–æ 0.5
‚Üí –£–ª—É—á—à–∏—Ç—å –ø—Ä–æ–º–ø—Ç –≤ node **Build AI Prompt**

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **–ü–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:** [DEPLOYMENT_CHECKLIST_OPENAI.md](DEPLOYMENT_CHECKLIST_OPENAI.md)
- **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è:** [AI_MULTI_ENTITY_EXTRACTOR_DOC.md](AI_MULTI_ENTITY_EXTRACTOR_DOC.md)
- **Multi-Appeal API:** [MULTI_APPEAL_API_DOCUMENTATION.md](MULTI_APPEAL_API_DOCUMENTATION.md)

---

**üéØ –¶–µ–ª—å:** –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å workflow ‚Üí –¢–µ—Å—Ç ‚Üí –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è ‚Üí Production

**‚è±Ô∏è –í—Ä–µ–º—è:** 10 –º–∏–Ω—É—Ç (–∏–º–ø–æ—Ä—Ç + —Ç–µ—Å—Ç) + 15 –º–∏–Ω—É—Ç (–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è) = **25 –º–∏–Ω—É—Ç**

---

**–ê–≤—Ç–æ—Ä:** Claude Code + User
**–î–∞—Ç–∞:** 2025-11-23
**–í–µ—Ä—Å–∏—è:** 1.0 (OpenAI GPT-4o-mini)
