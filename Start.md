# üöÄ START - –ö–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã

## üìÖ –î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
**22 –Ω–æ—è–±—Ä—è 2025** (–æ–±–Ω–æ–≤–ª–µ–Ω–æ: –¥–æ–±–∞–≤–ª–µ–Ω—ã –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã version control –¥–ª—è n8n –∏ Supabase, –ø—Ä–æ–µ–∫—Ç –Ω–∞ GitHub)

---

## ‚öôÔ∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –í–ï–†–°–ò–Ø–•

### n8n Version: **1.119.2**
‚ö†Ô∏è **–í–ê–ñ–ù–û:** –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å –≤–µ—Ä—Å–∏–µ–π 1.119.2 –ø–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º –≤–æ—Ä–∫–µ—Ä–æ–≤!
üìñ –°–º. [N8N_VERSION_INFO.md](N8N_VERSION_INFO.md) –¥–ª—è –¥–µ—Ç–∞–ª–µ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

### –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:
- **n8n_manager.py** - Python —Å–∫—Ä–∏–ø—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–æ—Ä–∫–µ—Ä–∞–º–∏ —á–µ—Ä–µ–∑ API
- **supabase_manager.py** - Python —Å–∫—Ä–∏–ø—Ç –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ —Å—Ö–µ–º—ã –ë–î (version control)
- **GitHub** - https://github.com/n8nRemacs/batterycrm (–ø–æ–ª–Ω—ã–π version control)
- **Supabase** - PostgreSQL –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (–¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ API)
- **n8n API** - https://n8n.n8nsrv.ru (API Key –Ω–∞—Å—Ç—Ä–æ–µ–Ω)

---

## üìñ –§–∞–π–ª—ã –¥–ª—è —á—Ç–µ–Ω–∏—è –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º

### ‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ (—á–∏—Ç–∞—Ç—å –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ):
1. **Eldoleado full.md** - –ø–æ–ª–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞, –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞, –≤—Å–µ –≤–æ—Ä–∫–µ—Ä—ã –∏ –∏—Ö –≤–∑–∞–∏–º–æ—Å–≤—è–∑–∏
2. **Database_Structure_BatteryCRM_COMPLETE.md** - —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (37 —Ç–∞–±–ª–∏—Ü)
3. **N8N_VERSION_INFO.md** - –ö–†–ò–¢–ò–ß–ù–û! –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–µ—Ä—Å–∏–∏ n8n –∏ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
4. **Start.md** (—ç—Ç–æ—Ç —Ñ–∞–π–ª) - —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –ø–ª–∞–Ω —Ä–∞–±–æ—Ç

### üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ (–ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏):
- **README_N8N_MANAGER.md** - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ä–∞–±–æ—Ç–µ —Å n8n –≤–æ—Ä–∫–µ—Ä–∞–º–∏
- **README_SUPABASE_MANAGER.md** - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —ç–∫—Å–ø–æ—Ä—Ç—É —Å—Ö–µ–º—ã –ë–î
- **README_GITHUB.md** - –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –¥–ª—è GitHub
- **–ü–ª–∞–Ω –ø–µ—Ä–µ—Ö–æ–¥–∞ Android API - –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –ò–ò.md** - –µ—Å–ª–∏ —Ä–∞–±–æ—Ç–∞–µ–º –Ω–∞–¥ –º–∏–≥—Ä–∞—Ü–∏–µ–π –Ω–∞ Android
- **Backend JSON/*.json** - –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –≤–æ—Ä–∫–µ—Ä, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –µ–≥–æ –∏–∑–º–µ–Ω—è—Ç—å
- **Backend JSON/IN Workers/*.json** - –≤—Ö–æ–¥—è—â–∏–µ –≤–æ—Ä–∫–µ—Ä—ã (Telegram, VK, WhatsApp...)
- **Backend JSON/OUT Workers/*.json** - –∏—Å—Ö–æ–¥—è—â–∏–µ –≤–æ—Ä–∫–µ—Ä—ã
- **Backend JSON/API Backend/*.json** - API –¥–ª—è Android –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

---

## üéØ –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

### ‚úÖ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–µ—Å—Å–∏–∏:

#### 1. Git & Version Control üî•
- ‚úÖ **Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π** –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
- ‚úÖ **GitHub** - –∫–æ–¥ –∑–∞–≥—Ä—É–∂–µ–Ω: https://github.com/n8nRemacs/batterycrm
- ‚úÖ **n8n_manager.py** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–æ—Ä–∫–µ—Ä–∞–º–∏ —á–µ—Ä–µ–∑ API (get/update/activate)
- ‚úÖ **supabase_manager.py** - —ç–∫—Å–ø–æ—Ä—Ç —Å—Ö–µ–º—ã –ë–î (26 —Ç–∞–±–ª–∏—Ü)
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω .gitignore (secrets, build files)
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã README –¥–ª—è –≤—Å–µ—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
- ‚úÖ 4 –∫–æ–º–º–∏—Ç–∞ —Å–¥–µ–ª–∞–Ω–æ, –≤—Å–µ –≤ –æ–±–ª–∞–∫–µ

#### 2. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚úÖ –°–æ–∑–¥–∞–Ω –ø–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–µ–∫—Ç–∞ **Eldoleado full.md** (15000+ —Å—Ç—Ä–æ–∫)
- ‚úÖ **N8N_VERSION_INFO.md** - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–µ—Ä—Å–∏–∏ 1.119.2
- ‚úÖ **README_N8N_MANAGER.md** - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ä–∞–±–æ—Ç–µ —Å –≤–æ—Ä–∫–µ—Ä–∞–º–∏
- ‚úÖ **README_SUPABASE_MANAGER.md** - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —ç–∫—Å–ø–æ—Ä—Ç—É –ë–î
- ‚úÖ **README_GITHUB.md** - –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
- ‚úÖ –û–ø–∏—Å–∞–Ω–∞ –≤—Å—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã
- ‚úÖ –ó–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤—Å–µ 9 —ç—Ç–∞–ø–æ–≤ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Ö–æ–¥—è—â–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
- ‚úÖ –û–ø–∏—Å–∞–Ω—ã –≤—Å–µ 5 API —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ –¥–ª—è Android
- ‚úÖ –†–∞—Å–ø–∏—Å–∞–Ω—ã –≤–∑–∞–∏–º–æ—Å–≤—è–∑–∏ –≤—Å–µ—Ö –≤–æ—Ä–∫–µ—Ä–æ–≤
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã 3 –±–∏–∑–Ω–µ—Å-—Å—Ü–µ–Ω–∞—Ä–∏—è —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã

#### 3. –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã —Ñ–∞–π–ª—ã **Stop.md** –∏ **Start.md** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω workflow –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è/–Ω–∞—á–∞–ª–∞ —Å–µ—Å—Å–∏–π
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω –¥–æ—Å—Ç—É–ø –∫ n8n API –∏ Supabase API

---

## üèóÔ∏è –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –ø—Ä–æ–µ–∫—Ç–µ (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ):

### –í—Ö–æ–¥—è—â–∏–π –ø–æ—Ç–æ–∫:
- ‚úÖ **BAT IN Telegram** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ Telegram (—Ç–µ–∫—Å—Ç + –≥–æ–ª–æ—Å)
- ‚úÖ **BAT_Tenant_Resolver** - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ tenant –ø–æ bot_token
- ‚úÖ **BAT Client Resolver** - –ø–æ–∏—Å–∫/—Å–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞
- ‚úÖ **BAT Client Creator** - —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
- ‚úÖ **BAT Appeal Manager** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞—â–µ–Ω–∏—è–º–∏

### AI –æ–±—Ä–∞–±–æ—Ç–∫–∞:
- ‚úÖ **BAT AI Appeal Router** - –æ—Å–Ω–æ–≤–Ω–æ–π AI –≤–æ—Ä–∫–µ—Ä
  - ‚úÖ 4 –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö AI Tools –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
  - ‚úÖ OpenAI GPT-4 –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤
  - ‚úÖ Postgres Chat Memory –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –¥–∏–∞–ª–æ–≥–æ–≤
  - ‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ appeals –ø–æ –º–µ—Ä–µ —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:
- ‚úÖ **BAT Operator Notifier** - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤
  - ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
  - ‚úÖ –í—ã–∑–æ–≤ BAT_FCM_Sender –¥–ª—è push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- ‚úÖ **BAT_FCM_Sender** - FCM push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–∞ Android
  - ‚úÖ JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ Google FCM
  - ‚úÖ –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### –ò—Å—Ö–æ–¥—è—â–∏–π –ø–æ—Ç–æ–∫:
- ‚úÖ **BAT Message Router** - –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤ –ø–æ –∫–∞–Ω–∞–ª–∞–º
- ‚úÖ **BAT OUT Telegram** - –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –∫–ª–∏–µ–Ω—Ç–∞–º –≤ Telegram

### Android API:
- ‚úÖ **API_Android_Auth** - –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤
  - ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ session_token
  - ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö mobile —Å–µ—Å—Å–∏–π
  - ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ FCM —Ç–æ–∫–µ–Ω–∞
- ‚úÖ **API_Operator_Appeals_List** - —Å–ø–∏—Å–æ–∫ –æ–±—Ä–∞—â–µ–Ω–∏–π —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
- ‚úÖ **API_Operator_Appeal_Detail** - –¥–µ—Ç–∞–ª–∏ –æ–±—Ä–∞—â–µ–Ω–∏—è + Meta API
- ‚úÖ **API_Operator_Send_Response** - –æ—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–≤–µ—Ç–∞ –∫–ª–∏–µ–Ω—Ç—É –∏–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:
- ‚úÖ **37 —Ç–∞–±–ª–∏—Ü** —Å –ø–æ–ª–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
- ‚úÖ Multi-tenant –∏–∑–æ–ª—è—Ü–∏—è —á–µ—Ä–µ–∑ tenant_id
- ‚úÖ JSONB –ø–æ–ª—è –¥–ª—è –≥–∏–±–∫–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- ‚úÖ –°–≤—è–∑–∏ –∏ –∏–Ω–¥–µ–∫—Å—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã

---

## ‚ö†Ô∏è –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ –Ω–µ–¥–æ—Ä–∞–±–æ—Ç–∫–∏:

### –ö—Ä–∏—Ç–∏—á–Ω—ã–µ:
- üî• **–õ–æ–≥–∏–∫–∞ —Å–±–æ—Ä–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —á–µ—Ä–µ–∑ AI Tools** - –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞–¥–∏—è–º–∏ –æ–±—Ä–∞—â–µ–Ω–∏—è:
  - –ù–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å—Ç–∞–¥–∏–∏ "–°–±–æ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞"
  - –ù–µ —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∏ –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è
  - AI Tools –≤—ã–∑—ã–≤–∞—é—Ç—Å—è –≤—Å–µ–≥–¥–∞, –¥–∞–∂–µ –Ω–∞ —ç—Ç–∞–ø–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è
  - –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–ª–Ω–æ—Ç—ã —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ—Ö–æ–¥–æ–º –≤ "–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞—è–≤–∫–∏"
- ‚ö†Ô∏è **–ù–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫** –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –≤–æ—Ä–∫–µ—Ä–∞—Ö (–Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å try-catch)
- ‚ö†Ô∏è **FCM —Ç–æ–∫–µ–Ω—ã** –Ω–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- ‚ö†Ô∏è **Session timeout** –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è operator_devices

### –°—Ä–µ–¥–Ω–∏–µ:
- ‚ö†Ô∏è **Universal Batcher** - –Ω–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –≤—Ä–µ–º–µ–Ω–∏ –æ–∂–∏–¥–∞–Ω–∏—è (—Å–µ–π—á–∞—Å 20 —Å–µ–∫)
- ‚ö†Ô∏è **Voice transcription** - –Ω–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–ª–∏–Ω–Ω—ã—Ö –≥–æ–ª–æ—Å–æ–≤—ã—Ö (>1 –º–∏–Ω)
- ‚ö†Ô∏è **Meta API** - –Ω–µ –≤—Å–µ –ø–æ–ª—è –∏–º–µ—é—Ç —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (format_type)

### –ù–∏–∑–∫–∏–µ:
- ‚ö†Ô∏è **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –Ω–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–±–æ—Ä–∞ –ª–æ–≥–æ–≤
- ‚ö†Ô∏è **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –Ω–µ—Ç –∞–ª–µ—Ä—Ç–æ–≤ –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ –≤–æ—Ä–∫–µ—Ä–æ–≤
- ‚ö†Ô∏è **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –Ω–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –≤–æ—Ä–∫–µ—Ä–æ–≤

---

## üìã –ü–ª–∞–Ω –Ω–∞ —Å–ª–µ–¥—É—é—â—É—é —Å–µ—Å—Å–∏—é

### üî¥ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–°–†–û–ß–ù–û):

#### –ó–∞–¥–∞—á–∞ 1.1: –£–ª—É—á—à–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ —Å–±–æ—Ä–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ç–∞–¥–∏—è–º–∏

**–ü—Ä–æ–±–ª–µ–º–∞:**
–°–µ–π—á–∞—Å AI Tools –≤—ã–∑—ã–≤–∞—é—Ç—Å—è —Å—Ä–∞–∑—É –ø—Ä–∏ –ø–µ—Ä–≤–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏, –Ω–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ç–∞–¥–∏—è–º–∏ –æ–±—Ä–∞—â–µ–Ω–∏—è, –Ω–µ —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∏ –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è.

**–¶–µ–ª—å:**
–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã —Å –∫–ª–∏–µ–Ω—Ç–æ–º:
1. **"–ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–æ–Ω—Ç–∞–∫—Ç"** - –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ (–±–µ–∑ –≤—ã–∑–æ–≤–∞ AI Tools)
2. **"–°–±–æ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞"** - —Å–±–æ—Ä –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π —á–µ—Ä–µ–∑ AI Tools
3. **"–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞—è–≤–∫–∏"** - –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è —Å–æ–±—Ä–∞–Ω—ã

---

#### –®–∞–≥–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

##### 1. –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø–æ–ª–µ–π –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

**–ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞: `context_fields_config`**
```sql
CREATE TABLE context_fields_config (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  tenant_id UUID NOT NULL REFERENCES tenants(id),
  deal_type_id UUID REFERENCES deal_types(id), -- –¥–ª—è –∫–∞–∫–æ–≥–æ —Ç–∏–ø–∞ —Å–¥–µ–ª–∫–∏
  field_name VARCHAR(100) NOT NULL, -- type, model_id, repair_type_id, parts_owner
  field_label VARCHAR(255) NOT NULL, -- "–¢–∏–ø –æ–±—Ä–∞—â–µ–Ω–∏—è", "–ú–æ–¥–µ–ª—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞"
  is_required BOOLEAN DEFAULT false, -- –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ?
  collection_order INT, -- –ø–æ—Ä—è–¥–æ–∫ —Å–±–æ—Ä–∞ (1, 2, 3...)
  tool_name VARCHAR(100), -- –∏–º—è AI Tool –¥–ª—è —Å–±–æ—Ä–∞ (Tool-Type, Tool-Model...)
  prompt_template TEXT, -- —à–∞–±–ª–æ–Ω –≤–æ–ø—Ä–æ—Å–∞ –∫–ª–∏–µ–Ω—Ç—É
  validation_rules JSONB, -- –ø—Ä–∞–≤–∏–ª–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
  is_active BOOLEAN DEFAULT true,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_context_fields_tenant ON context_fields_config(tenant_id);
CREATE INDEX idx_context_fields_deal_type ON context_fields_config(deal_type_id);
```

**–ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö:**
```sql
INSERT INTO context_fields_config (tenant_id, field_name, field_label, is_required, collection_order, tool_name) VALUES
  ('a0...', 'type', '–¢–∏–ø –æ–±—Ä–∞—â–µ–Ω–∏—è', true, 1, 'Tool-Type'),
  ('a0...', 'model_id', '–ú–æ–¥–µ–ª—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞', true, 2, 'Tool-Model'),
  ('a0...', 'repair_type_id', '–¢–∏–ø —Ä–µ–º–æ–Ω—Ç–∞', true, 3, 'Tool-Repair'),
  ('a0...', 'parts_owner', '–ß—å—è –∑–∞–ø—á–∞—Å—Ç—å', false, 4, 'Tool-Parts');
```

---

##### 2. –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ –ø–æ–ª–µ –≤ —Ç–∞–±–ª–∏—Ü—É appeals

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ç–∞–±–ª–∏—Ü–µ `appeals`:**
```sql
ALTER TABLE appeals ADD COLUMN IF NOT EXISTS context_completion_status JSONB DEFAULT '{}';

-- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ context_completion_status:
{
  "fields_collected": {
    "type": { "value": "—Ä–µ–º–æ–Ω—Ç", "collected_at": "2025-11-21T10:00:00Z", "is_valid": true },
    "model_id": { "value": "uuid", "collected_at": "2025-11-21T10:01:00Z", "is_valid": true },
    "repair_type_id": null,
    "parts_owner": null
  },
  "required_fields_count": 3,
  "collected_required_count": 2,
  "is_complete": false,
  "completion_percentage": 66.67
}
```

---

##### 3. –û–±–Ω–æ–≤–∏—Ç—å –ª–æ–≥–∏–∫—É BAT AI Appeal Router

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –≤–æ—Ä–∫–µ—Ä–µ:**

**3.1. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Å—Ç–∞–¥–∏–∏ –≤ –Ω–∞—á–∞–ª–µ:**
```javascript
// Node: Check Appeal Stage
const appeal = $input.first().json.appeal;
const currentStage = appeal.stage;
const isFirstContact = currentStage === '–ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–æ–Ω—Ç–∞–∫—Ç';
const isContextCollection = currentStage === '–°–±–æ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞';

return {
  ...($input.first().json),
  should_greet: isFirstContact,
  should_collect_context: isFirstContact || isContextCollection,
  current_stage: currentStage
};
```

**3.2. –î–æ–±–∞–≤–∏—Ç—å IF —É—Å–ª–æ–≤–∏–µ:**
```
IF should_greet === true:
  ‚Üí AI Agent (—Ç–æ–ª—å–∫–æ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ, –ë–ï–ó –≤—ã–∑–æ–≤–∞ Tools)
  ‚Üí Update Stage to "–°–±–æ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞"
  ‚Üí Send Response

IF should_collect_context === true:
  ‚Üí Load Context Fields Config (–∑–∞–≥—Ä—É–∑–∏—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è)
  ‚Üí Check What's Missing (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —É–∂–µ —Å–æ–±—Ä–∞–Ω–æ)
  ‚Üí Call Only Needed Tools (–≤—ã–∑–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ Tools)
  ‚Üí Update context_completion_status
  ‚Üí Check If Complete (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–ª–Ω–æ—Ç—É)
  ‚Üí IF complete: Update Stage to "–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞—è–≤–∫–∏"
  ‚Üí Send Response
```

**3.3. –ù–æ–≤—ã–π SQL –∑–∞–ø—Ä–æ—Å: Load Context Fields Config**
```sql
SELECT field_name, field_label, is_required, collection_order, tool_name
FROM context_fields_config
WHERE tenant_id = '{{ $json.tenant_id }}'
  AND is_active = true
  AND (deal_type_id IS NULL OR deal_type_id = '{{ $json.appeal.deal_type_id }}')
ORDER BY collection_order ASC;
```

**3.4. –ù–æ–≤—ã–π Node: Check What's Missing**
```javascript
const appeal = $input.first().json.appeal;
const requiredFields = $input.first().json.required_fields; // –∏–∑ config

const completionStatus = appeal.context_completion_status || {
  fields_collected: {},
  required_fields_count: 0,
  collected_required_count: 0
};

const missing = [];
const toolsToCall = [];

requiredFields.forEach(field => {
  const isCollected = !!appeal[field.field_name];

  if (!isCollected) {
    missing.push(field.field_label);
    toolsToCall.push(field.tool_name);
  }
});

return {
  ...($input.first().json),
  missing_fields: missing,
  tools_to_call: toolsToCall,
  is_complete: missing.length === 0
};
```

**3.5. Switch –ø–æ tools_to_call:**
```
IF tools_to_call –≤–∫–ª—é—á–∞–µ—Ç "Tool-Type":
  ‚Üí Call Tool - Type

IF tools_to_call –≤–∫–ª—é—á–∞–µ—Ç "Tool-Model":
  ‚Üí Call Tool - Model

IF tools_to_call –≤–∫–ª—é—á–∞–µ—Ç "Tool-Repair":
  ‚Üí Call Tool - Repair

IF tools_to_call –≤–∫–ª—é—á–∞–µ—Ç "Tool-Parts":
  ‚Üí Call Tool - Parts
```

**3.6. Update context_completion_status:**
```javascript
const extractedData = $json.extracted_data;
const requiredFields = $json.required_fields;

const fieldsCollected = {};
let collectedCount = 0;

requiredFields.forEach(field => {
  const value = extractedData[field.field_name];

  fieldsCollected[field.field_name] = value ? {
    value: value,
    collected_at: new Date().toISOString(),
    is_valid: true
  } : null;

  if (value && field.is_required) {
    collectedCount++;
  }
});

const requiredCount = requiredFields.filter(f => f.is_required).length;
const isComplete = collectedCount >= requiredCount;

const completionStatus = {
  fields_collected: fieldsCollected,
  required_fields_count: requiredCount,
  collected_required_count: collectedCount,
  is_complete: isComplete,
  completion_percentage: (collectedCount / requiredCount * 100).toFixed(2)
};

return {
  ...($json),
  context_completion_status: completionStatus,
  is_context_complete: isComplete
};
```

**3.7. Update Appeal with Stage:**
```sql
UPDATE appeals SET
  type = '{{ $json.extracted_data.type }}',
  model_id = '{{ $json.extracted_data.model_id }}'::uuid,
  repair_type_id = '{{ $json.extracted_data.repair_type_id }}'::uuid,
  parts_owner = '{{ $json.extracted_data.parts_owner }}',
  context_completion_status = '{{ $json.context_completion_status }}'::jsonb,
  stage = CASE
    WHEN '{{ $json.is_context_complete }}' = 'true' THEN '–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞—è–≤–∫–∏'
    ELSE '–°–±–æ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞'
  END,
  updated_at = NOW()
WHERE id = '{{ $json.appeal_id }}'::uuid;
```

---

##### 4. –û–±–Ω–æ–≤–∏—Ç—å AI Agent –ø—Ä–æ–º–ø—Ç—ã

**–ü—Ä–æ–º–ø—Ç –¥–ª—è –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è (stage = "–ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–æ–Ω—Ç–∞–∫—Ç"):**
```
–¢—ã ‚Äî –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ —Ü–µ–Ω—Ç—Ä–∞ –ø–æ —Ä–µ–º–æ–Ω—Ç—É iPhone.

–≠—Ç–æ –ø–µ—Ä–≤—ã–π –∫–æ–Ω—Ç–∞–∫—Ç —Å –∫–ª–∏–µ–Ω—Ç–æ–º. –¢–≤–æ—è –∑–∞–¥–∞—á–∞:
1. –ü–æ–ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–∞
2. –ö—Ä–∞—Ç–∫–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å—Å—è
3. –°–ø—Ä–æ—Å–∏—Ç—å, —á–µ–º –º–æ–∂–µ—à—å –ø–æ–º–æ—á—å

–ë—É–¥—å –∫—Ä–∞—Ç–∫–∏–º, –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –∏ –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–º.

–°–æ–æ–±—â–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞: "{{ $json.text }}"
```

**–ü—Ä–æ–º–ø—Ç –¥–ª—è —Å–±–æ—Ä–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (stage = "–°–±–æ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞"):**
```
–¢—ã ‚Äî –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ —Ü–µ–Ω—Ç—Ä–∞. –°–µ–π—á–∞—Å —Ç—ã —Å–æ–±–∏—Ä–∞–µ—à—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –æ–±—Ä–∞—â–µ–Ω–∏–∏.

–£–∂–µ —Å–æ–±—Ä–∞–Ω–æ:
{{ $json.fields_collected_summary }}

–ù–µ —Ö–≤–∞—Ç–∞–µ—Ç:
{{ $json.missing_fields }}

–ü–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞: "{{ $json.text }}"

–¢–≤–æ—è –∑–∞–¥–∞—á–∞:
1. –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ —É–∑–Ω–∞—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—é—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
2. –ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å –æ –°–õ–ï–î–£–Æ–©–ï–ú –Ω–µ–¥–æ—Å—Ç–∞—é—â–µ–º –ø–æ–ª–µ (–Ω–µ –æ–±–æ –≤—Å–µ—Ö —Å—Ä–∞–∑—É)
3. –ë—ã—Ç—å –∫—Ä–∞—Ç–∫–∏–º –∏ –ø–æ –¥–µ–ª—É

–ù–ï –∏—Å–ø–æ–ª—å–∑—É–π markdown.
```

---

##### 5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–æ–ª–Ω—ã–π flow**
```
–ö–ª–∏–µ–Ω—Ç: "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ"
–ë–æ—Ç: "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –Ø –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ —Ü–µ–Ω—Ç—Ä–∞. –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?"
Stage: –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–æ–Ω—Ç–∞–∫—Ç ‚Üí –°–±–æ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

–ö–ª–∏–µ–Ω—Ç: "–•–æ—á—É –ø–æ—á–∏–Ω–∏—Ç—å —Ç–µ–ª–µ—Ñ–æ–Ω"
–ë–æ—Ç: "–ü–æ–Ω—è–ª! –ö–∞–∫–∞—è –º–æ–¥–µ–ª—å –≤–∞—à–µ–≥–æ —Ç–µ–ª–µ—Ñ–æ–Ω–∞?"
Stage: –°–±–æ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
context_completion_status: { type: "—Ä–µ–º–æ–Ω—Ç", model_id: null, ... }

–ö–ª–∏–µ–Ω—Ç: "iPhone 14 Pro"
–ë–æ—Ç: "–û—Ç–ª–∏—á–Ω–æ! –ß—Ç–æ –∏–º–µ–Ω–Ω–æ –Ω—É–∂–Ω–æ –ø–æ—á–∏–Ω–∏—Ç—å?"
Stage: –°–±–æ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
context_completion_status: { type: "—Ä–µ–º–æ–Ω—Ç", model_id: "xxx", repair_type_id: null, ... }

–ö–ª–∏–µ–Ω—Ç: "–ó–∞–º–µ–Ω–∏—Ç—å –±–∞—Ç–∞—Ä–µ—é"
–ë–æ—Ç: "–ü–æ–Ω—è–ª. –ó–∞–ø—á–∞—Å—Ç—å –±—É–¥–µ—Ç –Ω–∞—à–∞ –∏–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å —Å–≤–æ—è?"
Stage: –°–±–æ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

–ö–ª–∏–µ–Ω—Ç: "–í–∞—à–∞"
–ë–æ—Ç: "–û—Ç–ª–∏—á–Ω–æ! –ó–∞–º–µ–Ω–∞ –±–∞—Ç–∞—Ä–µ–∏ iPhone 14 Pro, —Å—Ç–æ–∏–º–æ—Å—Ç—å 4500‚ÇΩ, –≤—Ä–µ–º—è 30 –º–∏–Ω—É—Ç. –ö–æ–≥–¥–∞ —É–¥–æ–±–Ω–æ –ø–æ–¥—ä–µ—Ö–∞—Ç—å?"
Stage: –°–±–æ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ ‚Üí –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞—è–≤–∫–∏
context_completion_status: { is_complete: true, completion_percentage: 100 }
```

**–°—Ü–µ–Ω–∞—Ä–∏–π 2: –ö–ª–∏–µ–Ω—Ç —Å—Ä–∞–∑—É –¥–∞–µ—Ç –≤—Å—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é**
```
–ö–ª–∏–µ–Ω—Ç: "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, –Ω—É–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –±–∞—Ç–∞—Ä–µ—é –Ω–∞ iPhone 14 Pro"
Stage: –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–æ–Ω—Ç–∞–∫—Ç ‚Üí –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞—è–≤–∫–∏ (–µ—Å–ª–∏ –≤—Å–µ –ø–æ–ª—è –∑–∞–ø–æ–ª–Ω–∏–ª–∏—Å—å)

–ë–æ—Ç: "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –û—Ç–ª–∏—á–Ω–æ, –∑–∞–º–µ–Ω–∞ –±–∞—Ç–∞—Ä–µ–∏ iPhone 14 Pro. –ó–∞–ø—á–∞—Å—Ç—å –±—É–¥–µ—Ç –Ω–∞—à–∞?"
Stage: –°–±–æ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (–µ—Å–ª–∏ parts_owner –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω)
```

---

### üü° –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–í–ê–ñ–ù–û):

#### –ó–∞–¥–∞—á–∞ 2.1: –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ Android –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
1. **–ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ UI/UX**
   - –≠–∫—Ä–∞–Ω—ã: Login, Appeals List, Appeal Detail, Chat
   - –ù–∞–≤–∏–≥–∞—Ü–∏—è –º–µ–∂–¥—É —ç–∫—Ä–∞–Ω–∞–º–∏
   - Material Design 3 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

2. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å API**
   - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (API_Android_Auth)
   - –°–ø–∏—Å–æ–∫ –æ–±—Ä–∞—â–µ–Ω–∏–π (API_Operator_Appeals_List)
   - –î–µ—Ç–∞–ª–∏ –æ–±—Ä–∞—â–µ–Ω–∏—è (API_Operator_Appeal_Detail)
   - –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–≤–µ—Ç–∞ (API_Operator_Send_Response)

3. **FCM Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**
   - –ü–æ–ª—É—á–µ–Ω–∏–µ FCM —Ç–æ–∫–µ–Ω–∞ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥—è—â–∏—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
   - Deep linking –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –æ–±—Ä–∞—â–µ–Ω–∏—é
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ badge

4. **Offline-first –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**
   - Room Database –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
   - WorkManager –¥–ª—è –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏
   - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–µ—Ç–∏

---

#### –ó–∞–¥–∞—á–∞ 2.2: –£–ª—É—á—à–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
- –î–æ–±–∞–≤–∏—Ç—å try-catch –≤–æ –≤—Å–µ –≤–æ—Ä–∫–µ—Ä—ã
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É
- –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∞–ª–µ—Ä—Ç—ã –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ—à–∏–±–∫–∞—Ö

#### –ó–∞–¥–∞—á–∞ 2.3: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ FCM —Ç–æ–∫–µ–Ω–æ–≤
- –°–æ–∑–¥–∞—Ç—å endpoint –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞
- –í—ã–∑—ã–≤–∞—Ç—å –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å —Ç–æ–∫–µ–Ω–∞

#### –ó–∞–¥–∞—á–∞ 2.4: Session Management
- –î–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π timeout (–Ω–∞–ø—Ä–∏–º–µ—Ä, 30 –¥–Ω–µ–π)
- –°–æ–∑–¥–∞—Ç—å endpoint –¥–ª—è refresh —Ç–æ–∫–µ–Ω–∞
- –î–æ–±–∞–≤–∏—Ç—å logout endpoint

#### –ó–∞–¥–∞—á–∞ 2.5: –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ Meta API
- –î–æ–±–∞–≤–∏—Ç—å –≤—Å–µ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ format_type
- –°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –¥–ª—è –∫–∞–∂–¥–æ–≥–æ deal_type
- –î–æ–±–∞–≤–∏—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–µ –ø–æ–ª—è (custom_fields)

---

### üü¢ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–ñ–ï–õ–ê–¢–ï–õ–¨–ù–û):

1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã**
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ ELK/Grafana
   - –°–æ–∑–¥–∞—Ç—å –¥–∞—à–±–æ—Ä–¥—ã –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –º–µ—Ç—Ä–∏–∫
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –≤ Telegram –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ –≤–æ—Ä–∫–µ—Ä–æ–≤

2. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**
   - –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
   - –°–æ–∑–¥–∞—Ç—å e2e —Ç–µ—Å—Ç—ã –¥–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CI/CD –¥–ª—è –∞–≤—Ç–æ—Ç–µ—Å—Ç–æ–≤

3. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**
   - –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å connection pooling –¥–ª—è PostgreSQL
   - –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å tenant_configs –≤ Redis

4. **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–∞–Ω–∞–ª—ã**
   - –î–æ—Ä–∞–±–æ—Ç–∞—Ç—å BAT IN VK
   - –î–æ—Ä–∞–±–æ—Ç–∞—Ç—å BAT IN WhatsApp
   - –î–æ–±–∞–≤–∏—Ç—å BAT IN Avito

---

## üîç –ö–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–π –∑–∞–¥–∞—á–∏

### üéØ –ù–∞–¥ —á–µ–º —Ä–∞–±–æ—Ç–∞–µ–º:
**–£–ª—É—á—à–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ —Å–±–æ—Ä–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ç–∞–¥–∏—è–º–∏ –æ–±—Ä–∞—â–µ–Ω–∏—è**

### üõ†Ô∏è –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:
1. –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É `context_fields_config` –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø–æ–ª–µ–π
2. –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `context_completion_status` –≤ —Ç–∞–±–ª–∏—Ü—É `appeals`
3. –û–±–Ω–æ–≤–∏—Ç—å –≤–æ—Ä–∫–µ—Ä **BAT AI Appeal Router**:
   - –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Å—Ç–∞–¥–∏–∏ (–ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–æ–Ω—Ç–∞–∫—Ç / –°–±–æ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ / –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞—è–≤–∫–∏)
   - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —É—Å–ª–æ–≤–Ω—ã–π –≤—ã–∑–æ–≤ AI Tools (—Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã—Ö)
   - –î–æ–±–∞–≤–∏—Ç—å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–æ–ª–Ω–æ—Ç—ã —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
   - –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è AI Agent

### üìÇ –§–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –∏–∑–º–µ–Ω—è—Ç—å—Å—è:
- **Database_Structure_BatteryCRM_COMPLETE.md** - –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é —Ç–∞–±–ª–∏—Ü—É –∏ –ø–æ–ª–µ
- **Backend JSON/BAT AI Appeal Router.json** - –ø–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ –ª–æ–≥–∏–∫–∏
- **Backend JSON/Tool - –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–∏–ø.json** (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
- **Backend JSON/Tool - –∏–∑–≤–ª–µ—á—å –º–æ–¥–µ–ª—å.json** (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
- **Backend JSON/Tool - –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ä–µ–º–æ–Ω—Ç.json** (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
- **Backend JSON/Tool - –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∑–∞–ø—á–∞—Å—Ç—å.json** (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

### üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –≤–æ—Ä–∫–µ—Ä—ã:
- **BAT AI Appeal Router** - –æ—Å–Ω–æ–≤–Ω–æ–π –≤–æ—Ä–∫–µ—Ä –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è
- **Tool-Type / Tool-Model / Tool-Repair / Tool-Parts** - AI Tools –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- **BAT Operator Notifier** - –ø–æ–ª—É—á–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏
- **BAT Appeal Manager** - —Å–æ–∑–¥–∞–µ—Ç appeals —Å –Ω–∞—á–∞–ª—å–Ω–æ–π —Å—Ç–∞–¥–∏–µ–π

### üìù –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è:

#### –°—Ç–∞–¥–∏–∏ –æ–±—Ä–∞—â–µ–Ω–∏—è (stages):
- **"–ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–æ–Ω—Ç–∞–∫—Ç"** - —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞, AI —Ç–æ–ª—å–∫–æ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ—Ç
- **"–°–±–æ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞"** - –ø–µ—Ä–µ—Ö–æ–¥ –ø–æ—Å–ª–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è, AI —Å–æ–±–∏—Ä–∞–µ—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è
- **"–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞—è–≤–∫–∏"** - –ø–µ—Ä–µ—Ö–æ–¥ –∫–æ–≥–¥–∞ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è —Å–æ–±—Ä–∞–Ω—ã
- **"–¢—Ä–µ–±—É–µ—Ç—Å—è —É—Ç–æ—á–Ω–µ–Ω–∏–µ"** - –µ—Å–ª–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä –≤–∑—è–ª –æ–±—Ä–∞—â–µ–Ω–∏–µ –≤ —Ä—É—á–Ω–æ–π —Ä–µ–∂–∏–º

#### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ vs –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:
- **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ** (is_required = true): type, model_id, repair_type_id
- **–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ** (is_required = false): parts_owner, estimated_cost
- –ü–µ—Ä–µ—Ö–æ–¥ –≤ "–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞—è–≤–∫–∏" –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —Å–±–æ—Ä–∞ **–≤—Å–µ—Ö –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö** –ø–æ–ª–µ–π

#### context_completion_status:
```json
{
  "fields_collected": {
    "type": { "value": "—Ä–µ–º–æ–Ω—Ç", "collected_at": "2025-11-21T10:00:00Z", "is_valid": true },
    "model_id": { "value": "uuid", "collected_at": "2025-11-21T10:01:00Z", "is_valid": true }
  },
  "required_fields_count": 3,
  "collected_required_count": 2,
  "is_complete": false,
  "completion_percentage": 66.67
}
```

#### –£—Å–ª–æ–≤–Ω—ã–π –≤—ã–∑–æ–≤ AI Tools:
- **–ù–ï –≤—ã–∑—ã–≤–∞–µ–º** Tools –Ω–∞ —Å—Ç–∞–¥–∏–∏ "–ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–æ–Ω—Ç–∞–∫—Ç"
- **–í—ã–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ** Tools –Ω–∞ —Å—Ç–∞–¥–∏–∏ "–°–±–æ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞"
- –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∫–∏–µ –ø–æ–ª—è —É–∂–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã —á–µ—Ä–µ–∑ `appeal[field_name]`
- –í—ã–∑—ã–≤–∞–µ–º Tools —Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–µ–∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –ø–æ–ª–µ–π

#### Postgres Chat Memory:
- session_id = appeal_id
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—Å—é –∏—Å—Ç–æ—Ä–∏—é –¥–∏–∞–ª–æ–≥–∞
- –ü–æ–∑–≤–æ–ª—è–µ—Ç AI –ø–æ–º–Ω–∏—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

#### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å flow —Å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ–º
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–π —Å–±–æ—Ä –ø–æ–ª–µ–π
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–π, –∫–æ–≥–¥–∞ –∫–ª–∏–µ–Ω—Ç –¥–∞–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ —Å—Ä–∞–∑—É
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ—Ö–æ–¥ —Å—Ç–∞–¥–∏–π

---

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- **n8n**: https://docs.n8n.io/
- **PostgreSQL**: https://www.postgresql.org/docs/
- **OpenAI API**: https://platform.openai.com/docs/
- **Firebase FCM**: https://firebase.google.com/docs/cloud-messaging
- **Android Jetpack**: https://developer.android.com/jetpack
- **Retrofit**: https://square.github.io/retrofit/
- **Room**: https://developer.android.com/training/data-storage/room

### Endpoints –ø—Ä–æ–µ–∫—Ç–∞:
- **n8n UI**: http://n8n.n8nsrv.ru
- **API Base URL**: https://n8n.n8nsrv.ru/webhook/
- **PostgreSQL**: [–≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏]

### Firebase:
- **Project ID**: batterycrm
- **Service Account**: firebase-adminsdk-fbsvc@batterycrm.iam.gserviceaccount.com

---

## üö® –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–º–µ–Ω—Ç—ã

### ‚ö†Ô∏è –ü–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º –≤–æ—Ä–∫–µ—Ä–æ–≤:
- [ ] –°–¥–µ–ª–∞–Ω backup –ë–î
- [ ] –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã —Ç–µ–∫—É—â–∏–µ –≤–µ—Ä—Å–∏–∏ –≤–æ—Ä–∫–µ—Ä–æ–≤
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –¥—Ä—É–≥–∏—Ö –≤–æ—Ä–∫–µ—Ä–æ–≤
- [ ] –ü–æ–Ω—è—Ç–Ω–æ, –∫–∞–∫ –æ—Ç–∫–∞—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è

### ‚úÖ –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–æ—Ä–∫–µ—Ä–æ–≤:
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ–ª–Ω—ã–π flow –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞ –¥–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Ä–∞–±–æ—Ç–∞ —Å —Ä–∞–∑–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ —Å–æ–æ–±—â–µ–Ω–∏–π (—Ç–µ–∫—Å—Ç, –≥–æ–ª–æ—Å, —Ñ–æ—Ç–æ)
- [ ] –û–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (Eldoleado full.md)
- [ ] –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î (–µ—Å–ª–∏ –º–µ–Ω—è–ª–∞—Å—å)
- [ ] –°–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π Start.md —Å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏

### üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã –≤—Å–µ tenant_id –≤ WHERE —É—Å–ª–æ–≤–∏—è—Ö (multi-tenant –∏–∑–æ–ª—è—Ü–∏—è)
- [ ] –ù–µ—Ç SQL-–∏–Ω—ä–µ–∫—Ü–∏–π (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏—è)
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- [ ] –ù–µ—Ç —É—Ç–µ—á–∫–∏ PII –≤ –ª–æ–≥–∞—Ö

---

## üéì –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã –ø—Ä–æ–µ–∫—Ç–∞

### Multi-Tenant:
- **–ü–æ–ª–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è** —á–µ—Ä–µ–∑ tenant_id
- **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** —á–µ—Ä–µ–∑ tenant_configs (jsonb)
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - –æ–¥–∏–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä –¥–ª—è –º–Ω–æ–≥–∏—Ö –∫–æ–º–ø–∞–Ω–∏–π

### Event-Driven:
- **n8n workflows** –∫–∞–∫ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã
- **Execute Workflow** –¥–ª—è —Å–≤—è–∑–∏ –º–µ–∂–¥—É –≤–æ—Ä–∫–µ—Ä–∞–º–∏
- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** —á–µ—Ä–µ–∑ –æ—á–µ—Ä–µ–¥–∏

### AI-First:
- **4 —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö AI –∞–≥–µ–Ω—Ç–∞** –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- **–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è –ø–∞–º—è—Ç—å** —á–µ—Ä–µ–∑ Postgres Chat Memory
- **Routing History** –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è AI —Ä–µ—à–µ–Ω–∏–π

### Mobile-First API:
- **RESTful** —Å session-based –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π
- **Meta API** –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ UI
- **Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** —á–µ—Ä–µ–∑ FCM

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è

### Performance:
- –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Ö–æ–¥—è—â–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è (—Ü–µ–ª—å: <3 —Å–µ–∫)
- –í—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ AI –æ—Ç–≤–µ—Ç–∞ (—Ü–µ–ª—å: <5 —Å–µ–∫)
- –í—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (—Ü–µ–ª—å: <1 —Å–µ–∫)

### Business:
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞—â–µ–Ω–∏–π –≤ –¥–µ–Ω—å
- –ü—Ä–æ—Ü–µ–Ω—Ç –æ–±—Ä–∞—â–µ–Ω–∏–π —Å –ø–æ–ª–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (full route)
- –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ vs —Ä—É—á–Ω—ã—Ö

### Technical:
- Uptime –≤–æ—Ä–∫–µ—Ä–æ–≤ (—Ü–µ–ª—å: 99.9%)
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫ –≤ –¥–µ–Ω—å (—Ü–µ–ª—å: <10)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ë–î (connections, queries/sec)

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ —Ä–∞–±–æ—Ç–µ

–ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —É–±–µ–¥–∏—Å—å:

- [ ] –ü—Ä–æ—á–∏—Ç–∞–Ω **Eldoleado full.md**
- [ ] –ü—Ä–æ—á–∏—Ç–∞–Ω–∞ **Database_Structure_BatteryCRM_COMPLETE.md**
- [ ] –ü—Ä–æ—á–∏—Ç–∞–Ω **Start.md** (—ç—Ç–æ—Ç —Ñ–∞–π–ª)
- [ ] –ü–æ–Ω—è—Ç–Ω–∞ —Ç–µ–∫—É—â–∞—è –∑–∞–¥–∞—á–∞
- [ ] –ü–æ–Ω—è—Ç–Ω—ã —Å–≤—è–∑–∏ –º–µ–∂–¥—É –≤–æ—Ä–∫–µ—Ä–∞–º–∏
- [ ] –ò–∑–≤–µ—Å—Ç–Ω—ã –≤—Å–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
- [ ] –ï—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ n8n UI (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
- [ ] –ï—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ –ë–î (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

---

## üéØ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ–∫—É—â–µ–π –∑–∞–¥–∞—á–∏

### –°–∏—Å—Ç–µ–º–∞ —Å–±–æ—Ä–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–æ–ª–∂–Ω–∞:

#### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:
1. ‚úÖ –¢–∞–±–ª–∏—Ü–∞ `context_fields_config` —Å–æ–∑–¥–∞–Ω–∞ —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
2. ‚úÖ –ü–æ–ª–µ `context_completion_status` –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ —Ç–∞–±–ª–∏—Ü—É `appeals`
3. ‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω—ã —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è tenant

#### –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:
1. ‚úÖ –ü—Ä–∏ –ø–µ—Ä–≤–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞:
   - Stage = "–ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–æ–Ω—Ç–∞–∫—Ç"
   - AI —Ç–æ–ª—å–∫–æ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ—Ç, –ù–ï –≤—ã–∑—ã–≤–∞–µ—Ç Tools
   - –ü–µ—Ä–µ—Ö–æ–¥ –≤ "–°–±–æ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞" –ø–æ—Å–ª–µ –æ—Ç–≤–µ—Ç–∞

2. ‚úÖ –ù–∞ —Å—Ç–∞–¥–∏–∏ "–°–±–æ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞":
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ–ª–µ–π –∏–∑ `context_fields_config`
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∫–∞–∫–∏–µ –ø–æ–ª—è —É–∂–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã
   - –í—ã–∑—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ Tools –¥–ª—è –Ω–µ–∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –ø–æ–ª–µ–π
   - –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è `context_completion_status` –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
   - –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø—Ä–æ—Ü–µ–Ω—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è

3. ‚úÖ –ü–µ—Ä–µ—Ö–æ–¥ –≤ "–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞—è–≤–∫–∏":
   - –ö–æ–≥–¥–∞ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è (is_required=true) —Å–æ–±—Ä–∞–Ω—ã
   - `context_completion_status.is_complete = true`
   - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—É –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è

#### AI Agent:
1. ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–∞–∑–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ç–∞–¥–∏–π
2. ‚úÖ –í–∏–¥–∏—Ç –ø–æ–ª–Ω—É—é –∏—Å—Ç–æ—Ä–∏—é —á–µ—Ä–µ–∑ Postgres Chat Memory
3. ‚úÖ –ó–∞–¥–∞–µ—Ç –≤–æ–ø—Ä–æ—Å—ã –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ, –ø–æ –æ–¥–Ω–æ–º—É –ø–æ–ª—é –∑–∞ —Ä–∞–∑
4. ‚úÖ –ù–µ –¥—É–±–ª–∏—Ä—É–µ—Ç —É–∂–µ —Å–æ–±—Ä–∞–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é

#### –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç:
1. ‚úÖ –ö–ª–∏–µ–Ω—Ç –∑–¥–æ—Ä–æ–≤–∞–µ—Ç—Å—è ‚Üí –ë–æ—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ—Ç ‚Üí –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å–±–æ—Ä
2. ‚úÖ –ö–ª–∏–µ–Ω—Ç –¥–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ —á–∞—Å—Ç—è–º ‚Üí –ë–æ—Ç —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Å–ª–µ–¥—É—é—â–µ–µ –ø–æ–ª–µ
3. ‚úÖ –ö–ª–∏–µ–Ω—Ç –¥–∞–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ —Å—Ä–∞–∑—É ‚Üí –ë–æ—Ç –∑–∞–ø–æ–ª–Ω—è–µ—Ç –≤—Å—ë, –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ "–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞—è–≤–∫–∏"
4. ‚úÖ context_completion_status –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è

---

## üí° –°–æ–≤–µ—Ç—ã –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–±–æ—Ç—ã

1. **–ù–∞—á–∏–Ω–∞–π —Å —á—Ç–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞** - –Ω–µ –ø—Ä–æ–ø—É—Å–∫–∞–π Eldoleado full.md
2. **–ò—Å–ø–æ–ª—å–∑—É–π TodoWrite** –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –≤ —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–¥–∞—á–∞—Ö
3. **–¢–µ—Å—Ç–∏—Ä—É–π –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ** - –ø—Ä–æ–≤–µ—Ä—è–π –∫–∞–∂–¥—ã–π —ç—Ç–∞–ø –æ—Ç–¥–µ–ª—å–Ω–æ
4. **–û–±–Ω–æ–≤–ª—è–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é —Å—Ä–∞–∑—É** - –Ω–µ –æ—Ç–∫–ª–∞–¥—ã–≤–∞–π –Ω–∞ –∫–æ–Ω–µ—Ü
5. **–°–æ–∑–¥–∞–≤–∞–π Start.md –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã—Ç–∏–µ–º** - —Å–ª–µ–¥—É—é—â–∞—è —Å–µ—Å—Å–∏—è –Ω–∞—á–Ω–µ—Ç—Å—è –±—ã—Å—Ç—Ä–µ–µ

---

## üîÑ Workflow —Ä–∞–±–æ—Ç—ã

```
1. –ß–∏—Ç–∞–µ–º Start.md
   ‚Üì
2. –ß–∏—Ç–∞–µ–º Eldoleado full.md + Database_Structure
   ‚Üì
3. –ë–µ—Ä–µ–º –∑–∞–¥–∞—á—É –∏–∑ –ø–ª–∞–Ω–∞ (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1)
   ‚Üì
4. –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Å–≤—è–∑–∞–Ω–Ω—ã–µ –≤–æ—Ä–∫–µ—Ä—ã
   ‚Üì
5. –†–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Ä–µ—à–µ–Ω–∏–µ
   ‚Üì
6. –¢–µ—Å—Ç–∏—Ä—É–µ–º
   ‚Üì
7. –û–±–Ω–æ–≤–ª—è–µ–º –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
   ‚Üì
8. –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π Start.md –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã—Ç–∏–µ–º
   ‚Üì
9. ‚úÖ –ì–æ—Ç–æ–≤–æ!
```

---

**üöÄ –ì–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ! –ù–∞—á–∏–Ω–∞–µ–º —Å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ Android –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.**
