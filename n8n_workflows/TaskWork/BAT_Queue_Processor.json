{
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "seconds",
              "secondsInterval": 5
            }
          ]
        }
      },
      "id": "88b4a4eb-ec7a-4245-ba38-0c74dfaf19cb",
      "name": "Every 5 Seconds",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        -1344,
        -80
      ]
    },
    {
      "parameters": {
        "operation": "get",
        "key": "queue:processor:lock",
        "options": {}
      },
      "id": "769e4efd-8ae0-4d12-860e-4e2ca7e1f284",
      "name": "Check Processor Lock",
      "type": "n8n-nodes-base.redis",
      "typeVersion": 1,
      "position": [
        -1120,
        -80
      ],
      "credentials": {
        "redis": {
          "id": "7FQcEivUY94atW24",
          "name": "Redis account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 2
          },
          "conditions": [
            {
              "id": "lock-check",
              "leftValue": "={{ $json.value }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "empty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "bcb7a0b8-2265-4e99-a9d7-36ea0505d7ac",
      "name": "Is Processor Free?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -896,
        -80
      ]
    },
    {
      "parameters": {
        "operation": "set",
        "key": "queue:processor:lock",
        "value": "processing",
        "expire": true
      },
      "id": "a4c3f02f-d600-48b2-b7c4-b295e0119bd9",
      "name": "Acquire Processor Lock",
      "type": "n8n-nodes-base.redis",
      "typeVersion": 1,
      "position": [
        -656,
        -80
      ],
      "credentials": {
        "redis": {
          "id": "7FQcEivUY94atW24",
          "name": "Redis account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Получаем сообщения из очереди через LRANGE\n// n8n Redis node не поддерживает LRANGE напрямую, используем GET для проверки\nreturn { ready: true, timestamp: new Date().toISOString() };"
      },
      "id": "27feed1e-8f5f-47a8-a061-b830cf64b9ba",
      "name": "Prepare Fetch",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -432,
        -80
      ]
    },
    {
      "parameters": {
        "operation": "pop",
        "list": "queue:incoming",
        "propertyName": "value",
        "options": {}
      },
      "id": "88b23d91-f02c-4cf4-8225-9964ca3f4469",
      "name": "Pop Message 1",
      "type": "n8n-nodes-base.redis",
      "typeVersion": 1,
      "position": [
        -144,
        -992
      ],
      "credentials": {
        "redis": {
          "id": "7FQcEivUY94atW24",
          "name": "Redis account"
        }
      }
    },
    {
      "parameters": {
        "operation": "pop",
        "list": "queue:incoming",
        "propertyName": "value",
        "options": {}
      },
      "id": "0606e83b-9eca-47ed-b2b3-3c1d845f55b3",
      "name": "Pop Message 2",
      "type": "n8n-nodes-base.redis",
      "typeVersion": 1,
      "position": [
        -144,
        -752
      ],
      "credentials": {
        "redis": {
          "id": "7FQcEivUY94atW24",
          "name": "Redis account"
        }
      }
    },
    {
      "parameters": {
        "operation": "pop",
        "list": "queue:incoming",
        "propertyName": "value",
        "options": {}
      },
      "id": "72eb8fee-98e0-4838-89e3-8be2b9fa709c",
      "name": "Pop Message 3",
      "type": "n8n-nodes-base.redis",
      "typeVersion": 1,
      "position": [
        -144,
        -560
      ],
      "credentials": {
        "redis": {
          "id": "7FQcEivUY94atW24",
          "name": "Redis account"
        }
      }
    },
    {
      "parameters": {
        "operation": "pop",
        "list": "queue:incoming",
        "propertyName": "value",
        "options": {}
      },
      "id": "a27984bc-d843-4a47-815b-b43235dd89a8",
      "name": "Pop Message 4",
      "type": "n8n-nodes-base.redis",
      "typeVersion": 1,
      "position": [
        -144,
        -384
      ],
      "credentials": {
        "redis": {
          "id": "7FQcEivUY94atW24",
          "name": "Redis account"
        }
      }
    },
    {
      "parameters": {
        "operation": "pop",
        "list": "queue:incoming",
        "propertyName": "value",
        "options": {}
      },
      "id": "38911348-c69e-4ea9-811f-86c5e06115ca",
      "name": "Pop Message 5",
      "type": "n8n-nodes-base.redis",
      "typeVersion": 1,
      "position": [
        -144,
        -160
      ],
      "credentials": {
        "redis": {
          "id": "7FQcEivUY94atW24",
          "name": "Redis account"
        }
      }
    },
    {
      "parameters": {
        "operation": "pop",
        "list": "queue:incoming",
        "propertyName": "value",
        "options": {}
      },
      "id": "63a81821-9adf-4dd0-9d64-9207d2356ba9",
      "name": "Pop Message 6",
      "type": "n8n-nodes-base.redis",
      "typeVersion": 1,
      "position": [
        -144,
        32
      ],
      "credentials": {
        "redis": {
          "id": "7FQcEivUY94atW24",
          "name": "Redis account"
        }
      }
    },
    {
      "parameters": {
        "operation": "pop",
        "list": "queue:incoming",
        "propertyName": "value",
        "options": {}
      },
      "id": "358b8078-d929-426d-818e-39698bb7e436",
      "name": "Pop Message 7",
      "type": "n8n-nodes-base.redis",
      "typeVersion": 1,
      "position": [
        -144,
        176
      ],
      "credentials": {
        "redis": {
          "id": "7FQcEivUY94atW24",
          "name": "Redis account"
        }
      }
    },
    {
      "parameters": {
        "operation": "pop",
        "list": "queue:incoming",
        "propertyName": "value",
        "options": {}
      },
      "id": "97661669-1214-48e6-bfef-8a9c2db047b0",
      "name": "Pop Message 8",
      "type": "n8n-nodes-base.redis",
      "typeVersion": 1,
      "position": [
        -144,
        304
      ],
      "credentials": {
        "redis": {
          "id": "7FQcEivUY94atW24",
          "name": "Redis account"
        }
      }
    },
    {
      "parameters": {
        "operation": "pop",
        "list": "queue:incoming",
        "propertyName": "value",
        "options": {}
      },
      "id": "f459a961-e3cc-497b-a8cd-f34f419333dc",
      "name": "Pop Message 9",
      "type": "n8n-nodes-base.redis",
      "typeVersion": 1,
      "position": [
        -144,
        496
      ],
      "credentials": {
        "redis": {
          "id": "7FQcEivUY94atW24",
          "name": "Redis account"
        }
      }
    },
    {
      "parameters": {
        "operation": "pop",
        "list": "queue:incoming",
        "propertyName": "value",
        "options": {}
      },
      "id": "cf0ef191-781e-4bc7-bff8-d2b457c83add",
      "name": "Pop Message 10",
      "type": "n8n-nodes-base.redis",
      "typeVersion": 1,
      "position": [
        -144,
        672
      ],
      "credentials": {
        "redis": {
          "id": "7FQcEivUY94atW24",
          "name": "Redis account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Собираем все сообщения из разных pop-операций\nconst allItems = $input.all();\nconst messages = [];\n\nfor (const item of allItems) {\n  const val = item.json?.value;\n  if (val && val !== null && val !== 'null' && val !== '') {\n    try {\n      const parsed = typeof val === 'string' ? JSON.parse(val) : val;\n      messages.push(parsed);\n    } catch (e) {\n      console.error('Failed to parse message:', val, e);\n    }\n  }\n}\n\nif (messages.length === 0) {\n  return { empty: true, count: 0 };\n}\n\n// Группируем по batch_key (channel:external_chat_id)\nconst groups = {};\nfor (const msg of messages) {\n  const batchKey = `${msg.channel}:${msg.external_chat_id}`;\n  if (!groups[batchKey]) {\n    groups[batchKey] = [];\n  }\n  groups[batchKey].push(msg);\n}\n\nreturn {\n  empty: false,\n  count: messages.length,\n  groups: groups,\n  group_keys: Object.keys(groups)\n};"
      },
      "id": "6f3ac85b-462b-4555-945e-d059eb5bbc33",
      "name": "Collect and Group Messages",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        80,
        -80
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "empty-check",
              "leftValue": "={{ $json.empty }}",
              "rightValue": true,
              "operator": {
                "type": "boolean",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "71e7a431-8865-4962-828f-1b4763f7d813",
      "name": "Is Queue Empty?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        304,
        -80
      ]
    },
    {
      "parameters": {
        "operation": "delete",
        "key": "queue:processor:lock"
      },
      "id": "1ae25761-9cb9-4196-936c-cd0598d11a9a",
      "name": "Release Lock (Empty)",
      "type": "n8n-nodes-base.redis",
      "typeVersion": 1,
      "position": [
        528,
        -176
      ],
      "credentials": {
        "redis": {
          "id": "7FQcEivUY94atW24",
          "name": "Redis account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "id": "b9ca5989-d401-4a15-9c0c-a324b729522c",
      "name": "Loop Over Batches",
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        768,
        -64
      ]
    },
    {
      "parameters": {
        "operation": "get",
        "key": "={{ $json.lock_key }}",
        "options": {}
      },
      "id": "83dbe090-dcba-4c78-b4a3-b32c7d04b8c4",
      "name": "Check Batch Lock",
      "type": "n8n-nodes-base.redis",
      "typeVersion": 1,
      "position": [
        1008,
        -80
      ],
      "credentials": {
        "redis": {
          "id": "7FQcEivUY94atW24",
          "name": "Redis account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const item = $('Loop Over Batches').first().json;\nconst lockValue = $json.value;\n\n// Если lock существует - добавляем в per-chat очередь\n// Если нет - создаём lock и запускаем дебаунс\nconst hasLock = lockValue && lockValue !== '' && lockValue !== null;\n\nreturn {\n  ...item,\n  has_lock: hasLock,\n  lock_value: lockValue\n};"
      },
      "id": "1c81f3a4-5029-4d5a-9a0b-a2ead6d14d97",
      "name": "Prepare Batch Decision",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1184,
        -80
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 2
          },
          "conditions": [
            {
              "id": "has-lock-check",
              "leftValue": "={{ $json.has_lock }}",
              "rightValue": true,
              "operator": {
                "type": "boolean",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "9bdf76fd-f793-4b73-9d21-867df3c94676",
      "name": "Has Batch Lock?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        1408,
        -80
      ]
    },
    {
      "parameters": {
        "jsCode": "// Добавляем сообщения в per-chat очередь (lock уже есть, кто-то обрабатывает)\nconst item = $json;\nconst messagesToPush = item.messages.map(m => JSON.stringify(m));\n\nreturn {\n  queue_key: item.queue_key,\n  messages_json: messagesToPush,\n  batch_key: item.batch_key,\n  action: 'queued_to_existing'\n};"
      },
      "id": "8884f1ca-6432-4ab5-9f1e-ebda5d90fe41",
      "name": "Prepare Queue Push",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1648,
        -240
      ]
    },
    {
      "parameters": {
        "operation": "push",
        "list": "={{ $json.queue_key }}",
        "messageData": "={{ $json.messages_json.join('|||SEPARATOR|||') }}",
        "tail": true
      },
      "id": "4c45be6d-9598-4cfb-b24b-124069cc4182",
      "name": "Push to Batch Queue",
      "type": "n8n-nodes-base.redis",
      "typeVersion": 1,
      "position": [
        1872,
        -240
      ],
      "credentials": {
        "redis": {
          "id": "7FQcEivUY94atW24",
          "name": "Redis account"
        }
      }
    },
    {
      "parameters": {
        "operation": "set",
        "key": "={{ $('Prepare Batch Decision').item.json.last_seen_key }}",
        "value": "={{ new Date().toISOString() }}"
      },
      "id": "26c348ee-1844-4087-a0ad-4261bc0ccba0",
      "name": "Update Last Seen (Existing)",
      "type": "n8n-nodes-base.redis",
      "typeVersion": 1,
      "position": [
        2096,
        -64
      ],
      "credentials": {
        "redis": {
          "id": "7FQcEivUY94atW24",
          "name": "Redis account"
        }
      }
    },
    {
      "parameters": {
        "operation": "set",
        "key": "={{ $json.lock_key }}",
        "value": "processing",
        "expire": true,
        "ttl": 300
      },
      "id": "ab36b513-d010-470d-af1b-bdfefc31cffe",
      "name": "Acquire Batch Lock",
      "type": "n8n-nodes-base.redis",
      "typeVersion": 1,
      "position": [
        1632,
        304
      ],
      "credentials": {
        "redis": {
          "id": "7FQcEivUY94atW24",
          "name": "Redis account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Первые сообщения для нового батча - сразу пушим в per-chat очередь\nconst item = $('Prepare Batch Decision').first().json;\nconst messagesToPush = item.messages.map(m => JSON.stringify(m));\n\nreturn {\n  queue_key: item.queue_key,\n  lock_key: item.lock_key,\n  last_seen_key: item.last_seen_key,\n  batch_key: item.batch_key,\n  channel: item.channel,\n  external_chat_id: item.external_chat_id,\n  messages_json: messagesToPush,\n  message_count: item.message_count,\n  action: 'new_batch_started'\n};"
      },
      "id": "f238003e-46cd-4ffe-8f30-4cdff9705cb8",
      "name": "Prepare New Batch",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1856,
        304
      ]
    },
    {
      "parameters": {
        "operation": "push",
        "list": "={{ $json.queue_key }}",
        "messageData": "={{ $json.messages_json.join('|||SEPARATOR|||') }}",
        "tail": true
      },
      "id": "4c29ed37-8a3a-4363-bd81-e1d107b32ee3",
      "name": "Push New Batch Messages",
      "type": "n8n-nodes-base.redis",
      "typeVersion": 1,
      "position": [
        2080,
        304
      ],
      "credentials": {
        "redis": {
          "id": "7FQcEivUY94atW24",
          "name": "Redis account"
        }
      }
    },
    {
      "parameters": {
        "operation": "set",
        "key": "={{ $('Prepare New Batch').item.json.last_seen_key }}",
        "value": "={{ new Date().toISOString() }}"
      },
      "id": "0864bd09-2917-44bc-bc20-7d43841210c8",
      "name": "Set Last Seen (New)",
      "type": "n8n-nodes-base.redis",
      "typeVersion": 1,
      "position": [
        2304,
        304
      ],
      "credentials": {
        "redis": {
          "id": "7FQcEivUY94atW24",
          "name": "Redis account"
        }
      }
    },
    {
      "parameters": {
        "operation": "push",
        "list": "queue:debounce:pending",
        "messageData": "={{ JSON.stringify({ batch_key: $('Prepare New Batch').item.json.batch_key, channel: $('Prepare New Batch').item.json.channel, external_chat_id: $('Prepare New Batch').item.json.external_chat_id, queue_key: $('Prepare New Batch').item.json.queue_key, lock_key: $('Prepare New Batch').item.json.lock_key, last_seen_key: $('Prepare New Batch').item.json.last_seen_key, start_time: new Date().toISOString() }) }}",
        "tail": true
      },
      "id": "b074fcc8-e61c-4879-a149-f07dfb92665e",
      "name": "Push to Debounce Queue",
      "type": "n8n-nodes-base.redis",
      "typeVersion": 1,
      "position": [
        2512,
        304
      ],
      "credentials": {
        "redis": {
          "id": "7FQcEivUY94atW24",
          "name": "Redis account"
        }
      }
    },
    {
      "parameters": {
        "operation": "delete",
        "key": "queue:processor:lock"
      },
      "id": "14c0918f-c93b-49cb-a42b-c47c588708d8",
      "name": "Release Processor Lock",
      "type": "n8n-nodes-base.redis",
      "typeVersion": 1,
      "position": [
        944,
        -240
      ],
      "credentials": {
        "redis": {
          "id": "7FQcEivUY94atW24",
          "name": "Redis account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Разворачиваем группы в отдельные items для обработки\nconst groups = $json.groups;\nconst groupKeys = $json.group_keys;\n\nconst items = groupKeys.map(key => {\n  const messages = groups[key];\n  const [channel, ...chatParts] = key.split(':');\n  const chatId = chatParts.join(':');\n  \n  return {\n    json: {\n      batch_key: key,\n      channel: channel,\n      external_chat_id: chatId,\n      messages: messages,\n      message_count: messages.length,\n      queue_key: `queue:batch:${key}`,\n      lock_key: `lock:batch:${key}`,\n      last_seen_key: `last_seen:${key}`\n    }\n  };\n});\n\nreturn items;"
      },
      "id": "a4abf2be-bb1c-489c-b9f5-76162cdc197d",
      "name": "Split to Batch Items",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        528,
        32
      ]
    }
  ],
  "connections": {
    "Every 5 Seconds": {
      "main": [
        [
          {
            "node": "Check Processor Lock",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check Processor Lock": {
      "main": [
        [
          {
            "node": "Is Processor Free?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Is Processor Free?": {
      "main": [
        [
          {
            "node": "Acquire Processor Lock",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Acquire Processor Lock": {
      "main": [
        [
          {
            "node": "Prepare Fetch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prepare Fetch": {
      "main": [
        [
          {
            "node": "Pop Message 1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Pop Message 2",
            "type": "main",
            "index": 0
          },
          {
            "node": "Pop Message 3",
            "type": "main",
            "index": 0
          },
          {
            "node": "Pop Message 4",
            "type": "main",
            "index": 0
          },
          {
            "node": "Pop Message 5",
            "type": "main",
            "index": 0
          },
          {
            "node": "Pop Message 6",
            "type": "main",
            "index": 0
          },
          {
            "node": "Pop Message 7",
            "type": "main",
            "index": 0
          },
          {
            "node": "Pop Message 8",
            "type": "main",
            "index": 0
          },
          {
            "node": "Pop Message 9",
            "type": "main",
            "index": 0
          },
          {
            "node": "Pop Message 10",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Pop Message 1": {
      "main": [
        [
          {
            "node": "Collect and Group Messages",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Pop Message 2": {
      "main": [
        [
          {
            "node": "Collect and Group Messages",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Pop Message 3": {
      "main": [
        [
          {
            "node": "Collect and Group Messages",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Pop Message 4": {
      "main": [
        [
          {
            "node": "Collect and Group Messages",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Pop Message 5": {
      "main": [
        [
          {
            "node": "Collect and Group Messages",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Pop Message 6": {
      "main": [
        [
          {
            "node": "Collect and Group Messages",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Pop Message 7": {
      "main": [
        [
          {
            "node": "Collect and Group Messages",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Pop Message 8": {
      "main": [
        [
          {
            "node": "Collect and Group Messages",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Pop Message 9": {
      "main": [
        [
          {
            "node": "Collect and Group Messages",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Pop Message 10": {
      "main": [
        [
          {
            "node": "Collect and Group Messages",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Collect and Group Messages": {
      "main": [
        [
          {
            "node": "Is Queue Empty?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Is Queue Empty?": {
      "main": [
        [
          {
            "node": "Release Lock (Empty)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Split to Batch Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Batches": {
      "main": [
        [
          {
            "node": "Check Batch Lock",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Release Processor Lock",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check Batch Lock": {
      "main": [
        [
          {
            "node": "Prepare Batch Decision",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prepare Batch Decision": {
      "main": [
        [
          {
            "node": "Has Batch Lock?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Has Batch Lock?": {
      "main": [
        [
          {
            "node": "Prepare Queue Push",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Acquire Batch Lock",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prepare Queue Push": {
      "main": [
        [
          {
            "node": "Push to Batch Queue",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Push to Batch Queue": {
      "main": [
        [
          {
            "node": "Update Last Seen (Existing)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update Last Seen (Existing)": {
      "main": [
        [
          {
            "node": "Loop Over Batches",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Acquire Batch Lock": {
      "main": [
        [
          {
            "node": "Prepare New Batch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prepare New Batch": {
      "main": [
        [
          {
            "node": "Push New Batch Messages",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Push New Batch Messages": {
      "main": [
        [
          {
            "node": "Set Last Seen (New)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Last Seen (New)": {
      "main": [
        [
          {
            "node": "Push to Debounce Queue",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Push to Debounce Queue": {
      "main": [
        [
          {
            "node": "Loop Over Batches",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split to Batch Items": {
      "main": [
        [
          {
            "node": "Loop Over Batches",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "meta": {
    "instanceId": "8ae77ca901b15c37bb42b26ea9b5a21b78217dd557a563108d875a64964c49bb"
  }
}
